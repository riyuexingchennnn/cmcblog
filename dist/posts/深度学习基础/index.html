<!DOCTYPE html><html class="transition bg-[var(--page-bg)] md:text-[16px] text-[14px]" data-astro-cid-sckkx6r4 data-overlayscrollbars-initialize lang=zh-CN style=--bannerOffset:30vh;--banner-height-home:65vh;--banner-height:35vh;--configHue:250;--page-width:75rem><head><title>深度学习基础 - 日月星辰</title><meta charset=UTF-8><meta content="深度学习基础 - 日月星辰" name=description><meta content=日月星辰 name=author><meta content=日月星辰 property=og:site_name><meta content=https://riyuexingchennnn.github.io/posts/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80/ property=og:url><meta content="深度学习基础 - 日月星辰" property=og:title><meta content="深度学习基础 - 日月星辰" property=og:description><meta content=article property=og:type><meta content=summary_large_image name=twitter:card><meta content=https://riyuexingchennnn.github.io/posts/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80/ property=twitter:url><meta content="深度学习基础 - 日月星辰" name=twitter:title><meta content="深度学习基础 - 日月星辰" name=twitter:description><meta content="width=device-width" name=viewport><meta content="Astro v4.16.7" name=generator><link href=/favicon/icon.png rel=icon media="(prefers-color-scheme: light)" sizes=32x32><script>!function(){switch(localStorage.getItem("theme")||"auto"){case"light":document.documentElement.classList.remove("dark");break;case"dark":document.documentElement.classList.add("dark");break;case"auto":window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")}let e=Math.floor(.3*window.innerHeight);e-=e%4,document.documentElement.style.setProperty("--banner-height-extend",`${e}px`);const t=parseFloat(getComputedStyle(document.documentElement).fontSize),n=75*t,o=(window.innerWidth-n)/2-t;document.documentElement.style.setProperty("--toc-width",`${o}px`)}()</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"深度学习基础","description":"深度学习基础","keywords":["深度学习"],"author":{"@type":"Person","name":"日月星辰","url":"https://riyuexingchennnn.github.io/"},"datePublished":"2024-11-27","inLanguage":"zh-CN"}</script><link href=https://cdn.staticfile.net/KaTeX/0.16.9/katex.min.css rel=stylesheet crossorigin=anonymous integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV><link href=https://riyuexingchennnn.github.io/rss.xml rel=alternate title=日月星辰 type=application/rss+xml><link href=/_astro/hoisted.DbgSiMEJ.css rel=stylesheet><style>#post-container :first-child{animation-delay:calc(var(--content-delay) + 0ms)}#post-container :nth-child(2){animation-delay:calc(var(--content-delay) + 50ms)}#post-container :nth-child(3){animation-delay:calc(var(--content-delay) + .1s)}#post-container :nth-child(4){animation-delay:calc(var(--content-delay) + 175ms)}#post-container :nth-child(5){animation-delay:calc(var(--content-delay) + .25s)}#post-container :nth-child(6){animation-delay:calc(var(--content-delay) + 325ms)}</style><link href=/_astro/_page_.BRTvV6Go.css rel=stylesheet><link href=/_astro/about.DNCrpOWW.css rel=stylesheet><link href=/_astro/_page_.BIfGqQol.css rel=stylesheet><style>#display-setting.svelte-3akcb9 input[type=range].svelte-3akcb9{-webkit-appearance:none;height:1.5rem;background-image:var(--color-selection-bar);transition:background-image .15s ease-in-out}#display-setting.svelte-3akcb9 .svelte-3akcb9::-webkit-slider-thumb{-webkit-appearance:none;height:1rem;width:.5rem;border-radius:.125rem;background:#ffffffb3;box-shadow:none}#display-setting.svelte-3akcb9 .svelte-3akcb9::-webkit-slider-thumb:hover{background:#fffc}#display-setting.svelte-3akcb9 .svelte-3akcb9::-webkit-slider-thumb:active{background:#fff9}#display-setting.svelte-3akcb9 .svelte-3akcb9::-moz-range-thumb{-webkit-appearance:none;height:1rem;width:.5rem;border-radius:.125rem;border-width:0;background:#ffffffb3;box-shadow:none}#display-setting.svelte-3akcb9 .svelte-3akcb9::-moz-range-thumb:hover{background:#fffc}#display-setting.svelte-3akcb9 .svelte-3akcb9::-moz-range-thumb:active{background:#fff9}#display-setting.svelte-3akcb9.svelte-3akcb9::-ms-thumb{-webkit-appearance:none;height:1rem;width:.5rem;border-radius:.125rem;background:#ffffffb3;box-shadow:none}#display-setting.svelte-3akcb9.svelte-3akcb9::-ms-thumb:hover{background:#fffc}#display-setting.svelte-3akcb9.svelte-3akcb9::-ms-thumb:active{background:#fff9}</style><script type=module src=/_astro/hoisted.BKLo-SOE.js></script><script type=module src=/_astro/page.D0rYE--H.js></script></head><body class="transition min-h-screen" data-astro-cid-sckkx6r4 data-overlayscrollbars-initialize style=--bannerOffset:30vh;--banner-height-home:65vh;--banner-height:35vh;--configHue:250;--page-width:75rem><div id=config-carrier data-hue=250></div><div><div class="mx-auto relative max-w-[var(--page-width)] duration-700 md:px-4 pointer-events-none px-0 transition-all z-50" id=top-row><div class="transition-all sticky pointer-events-auto top-0" id=navbar-wrapper><div class="onload-animation z-50" id=navbar><div class="transition absolute -top-8 bg-[var(--card-bg)] h-8 left-0 right-0"></div><div class="flex items-center px-4 card-base h-[4.5rem] justify-between max-w-[var(--page-width)] mx-auto overflow-visible rounded-t-none"><a href=/ class="rounded-lg font-bold active:scale-95 btn-plain px-5 scale-animation h-[3.25rem]"><div class="flex items-center flex-row text-[var(--primary)] text-md"><svg data-icon=material-symbols:home-outline-rounded height=1em viewBox="0 0 24 24" width=1em class="text-[1.75rem] mb-1 mr-2"><symbol id=ai:material-symbols:home-outline-rounded><path d="M6 19h3v-5q0-.425.288-.712T10 13h4q.425 0 .713.288T15 14v5h3v-9l-6-4.5L6 10zm-2 0v-9q0-.475.213-.9t.587-.7l6-4.5q.525-.4 1.2-.4t1.2.4l6 4.5q.375.275.588.7T20 10v9q0 .825-.588 1.413T18 21h-4q-.425 0-.712-.288T13 20v-5h-2v5q0 .425-.288.713T10 21H6q-.825 0-1.412-.587T4 19m8-6.75" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:home-outline-rounded></use></svg> 日月星辰</div></a><div class="md:flex hidden"><a href=/ class="rounded-lg font-bold active:scale-95 btn-plain px-5 scale-animation h-11" aria-label=主页><div class="flex items-center">主页</div></a><a href=/archive/ class="rounded-lg font-bold active:scale-95 btn-plain px-5 scale-animation h-11" aria-label=归档><div class="flex items-center">归档</div></a><a href=/about/ class="rounded-lg font-bold active:scale-95 btn-plain px-5 scale-animation h-11" aria-label=关于><div class="flex items-center">关于</div></a><a href=https://github.com/riyuexingchennnn class="rounded-lg font-bold active:scale-95 btn-plain px-5 scale-animation h-11" target=_blank aria-label=GitHub><div class="flex items-center">GitHub <svg data-icon=fa6-solid:arrow-up-right-from-square height=1em viewBox="0 0 512 512" width=1em class="transition -translate-y-[1px] dark:text-white/[0.2] ml-1 text-[0.875rem] text-black/[0.2]"><symbol id=ai:fa6-solid:arrow-up-right-from-square><path d="M320 0c-17.7 0-32 14.3-32 32s14.3 32 32 32h82.7L201.4 265.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L448 109.3V192c0 17.7 14.3 32 32 32s32-14.3 32-32V32c0-17.7-14.3-32-32-32zM80 32C35.8 32 0 67.8 0 112v320c0 44.2 35.8 80 80 80h320c44.2 0 80-35.8 80-80V320c0-17.7-14.3-32-32-32s-32 14.3-32 32v112c0 8.8-7.2 16-16 16H80c-8.8 0-16-7.2-16-16V112c0-8.8 7.2-16 16-16h112c17.7 0 32-14.3 32-32s-14.3-32-32-32z" fill=currentColor /></symbol><use xlink:href=#ai:fa6-solid:arrow-up-right-from-square></use></svg></div></a></div><div class=flex><style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(self.Astro||(self.Astro={})).load=async t=>{await(await t())()},window.dispatchEvent(new Event("astro:load")),(()=>{var t=Object.defineProperty,e=(e,r,n)=>((e,r,n)=>r in e?t(e,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[r]=n)(e,"symbol"!=typeof r?r+"":r,n);{let t={0:t=>s(t),1:t=>n(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(n(t)),5:t=>new Set(n(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t),11:t=>1/0*t},r=e=>{let[r,n]=e;return r in t?t[r](n):void 0},n=t=>t.map(r),s=t=>"object"!=typeof t||null===t?t:Object.fromEntries(Object.entries(t).map((([t,e])=>[t,r(e)])));class i extends HTMLElement{constructor(){super(...arguments),e(this,"Component"),e(this,"hydrator"),e(this,"hydrate",(async()=>{var t;if(!this.hydrator||!this.isConnected)return;let e=null==(t=this.parentElement)?void 0:t.closest("astro-island[ssr]");if(e)return void e.addEventListener("astro:hydrate",this.hydrate,{once:!0});let r,n=this.querySelectorAll("astro-slot"),i={},o=this.querySelectorAll("template[data-astro-template]");for(let t of o){let e=t.closest(this.tagName);null!=e&&e.isSameNode(this)&&(i[t.getAttribute("data-astro-template")||"default"]=t.innerHTML,t.remove())}for(let t of n){let e=t.closest(this.tagName);null!=e&&e.isSameNode(this)&&(i[t.getAttribute("name")||"default"]=t.innerHTML)}try{r=this.hasAttribute("props")?s(JSON.parse(this.getAttribute("props"))):{}}catch(t){let e=this.getAttribute("component-url")||"<unknown>",r=this.getAttribute("component-export");throw r&&(e+=` (export ${r})`),console.error(`[hydrate] Error parsing props for component ${e}`,this.getAttribute("props"),t),t}await this.hydrator(this)(this.Component,r,i,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))})),e(this,"unmount",(()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))}))}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(this.hasAttribute("await-children")&&"interactive"!==document.readyState&&"complete"!==document.readyState){let t=()=>{document.removeEventListener("DOMContentLoaded",t),e.disconnect(),this.childrenConnectedCallback()},e=new MutationObserver((()=>{var e;(null==(e=this.lastChild)?void 0:e.nodeType)===Node.COMMENT_NODE&&"astro:end"===this.lastChild.nodeValue&&(this.lastChild.remove(),t())}));e.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",t)}else this.childrenConnectedCallback()}async childrenConnectedCallback(){let t=this.getAttribute("before-hydration-url");t&&await import(t),this.start()}async start(){let t=JSON.parse(this.getAttribute("opts")),e=this.getAttribute("client");if(void 0!==Astro[e])try{await Astro[e]((async()=>{let t=this.getAttribute("renderer-url"),[e,{default:r}]=await Promise.all([import(this.getAttribute("component-url")),t?import(t):()=>()=>{}]),n=this.getAttribute("component-export")||"default";if(n.includes(".")){this.Component=e;for(let t of n.split("."))this.Component=this.Component[t]}else this.Component=e[n];return this.hydrator=r,this.hydrate}),t,this)}catch(t){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,t)}else window.addEventListener(`astro:${e}`,(()=>this.start()),{once:!0})}attributeChangedCallback(){this.hydrate()}}e(i,"observedAttributes",["props"]),customElements.get("astro-island")||customElements.define("astro-island",i)}})()</script><astro-island await-children="" client=load component-export=default component-url=/_astro/Search.ok0hWTTD.js opts={&quot;name&quot;:&quot;Search&quot;,&quot;value&quot;:true} props={} renderer-url=/_astro/client.CWY0IrnN.js ssr="" uid=1141w1><div class="rounded-lg items-center bg-black/[0.04] dark:bg-white/5 dark:focus-within:bg-white/10 dark:hover:bg-white/10 focus-within:bg-black/[0.06] h-11 hidden hover:bg-black/[0.06] lg:flex mr-2 transition-all" id=search-bar><astro-slot name=search-icon><svg data-icon=material-symbols:search height=1em viewBox="0 0 24 24" width=1em class="transition absolute pointer-events-none dark:text-white/30 ml-3 my-auto text-[1.25rem] text-black/30" slot=search-icon><symbol id=ai:material-symbols:search><path d="m19.6 21l-6.3-6.3q-.75.6-1.725.95T9.5 16q-2.725 0-4.612-1.888T3 9.5t1.888-4.612T9.5 3t4.613 1.888T16 9.5q0 1.1-.35 2.075T14.7 13.3l6.3 6.3zM9.5 14q1.875 0 3.188-1.312T14 9.5t-1.312-3.187T9.5 5T6.313 6.313T5 9.5t1.313 3.188T9.5 14" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:search></use></svg></astro-slot><input class="text-sm bg-transparent dark:text-white/50 focus:w-60 outline-0 pl-10 svelte-1gu5h8y text-black/50 active:w-60 h-full transition-all w-40" placeholder=搜索 value=""></div><button class="rounded-lg btn-plain scale-animation h-11 active:scale-90 w-11 lg:hidden" aria-label="Search Panel" id=search-switch><astro-slot name=search-switch><svg data-icon=material-symbols:search height=1em viewBox="0 0 24 24" width=1em class=text-[1.25rem] slot=search-switch><use xlink:href=#ai:material-symbols:search></use></svg></astro-slot></button><div class="absolute float-panel-closed float-panel right-4 left-4 md:left-[unset] md:w-[30rem] p-2 rounded-2xl search-panel shadow-2xl top-20" id=search-panel><div class="flex items-center relative bg-black/[0.04] dark:bg-white/5 dark:focus-within:bg-white/10 dark:hover:bg-white/10 focus-within:bg-black/[0.06] h-11 hover:bg-black/[0.06] lg:hidden rounded-xl transition-all" id=search-bar-inside><astro-slot name=search-icon><svg data-icon=material-symbols:search height=1em viewBox="0 0 24 24" width=1em class="transition absolute pointer-events-none dark:text-white/30 ml-3 my-auto text-[1.25rem] text-black/30" slot=search-icon><symbol id=ai:material-symbols:search><path d="m19.6 21l-6.3-6.3q-.75.6-1.725.95T9.5 16q-2.725 0-4.612-1.888T3 9.5t1.888-4.612T9.5 3t4.613 1.888T16 9.5q0 1.1-.35 2.075T14.7 13.3l6.3 6.3zM9.5 14q1.875 0 3.188-1.312T14 9.5t-1.312-3.187T9.5 5T6.313 6.313T5 9.5t1.313 3.188T9.5 14" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:search></use></svg></astro-slot><input class="text-sm bg-transparent dark:text-white/50 focus:w-60 outline-0 pl-10 svelte-1gu5h8y text-black/50 absolute inset-0" placeholder=Search value=""></div></div><template data-astro-template=arrow-icon><svg data-icon=fa6-solid:chevron-right height=1em viewBox="0 0 320 512" width=0.63em class="transition text-[var(--primary)] my-auto text=[0.75rem] translate-x-0.5" slot=arrow-icon><symbol id=ai:fa6-solid:chevron-right><path d="M310.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L242.7 256L73.4 86.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l192 192z" fill=currentColor /></symbol><use xlink:href=#ai:fa6-solid:chevron-right></use></svg></template><!--astro:end--></astro-island><button class="rounded-lg btn-plain scale-animation h-11 active:scale-90 w-11" aria-label="Display Settings" id=display-settings-switch><svg data-icon=material-symbols:palette-outline height=1em viewBox="0 0 24 24" width=1em class=text-[1.25rem]><symbol id=ai:material-symbols:palette-outline><path d="M12 22q-2.05 0-3.875-.788t-3.187-2.15t-2.15-3.187T2 12q0-2.075.813-3.9t2.2-3.175T8.25 2.788T12.2 2q2 0 3.775.688t3.113 1.9t2.125 2.875T22 11.05q0 2.875-1.75 4.413T16 17h-1.85q-.225 0-.312.125t-.088.275q0 .3.375.863t.375 1.287q0 1.25-.687 1.85T12 22m-5.5-9q.65 0 1.075-.425T8 11.5t-.425-1.075T6.5 10t-1.075.425T5 11.5t.425 1.075T6.5 13m3-4q.65 0 1.075-.425T11 7.5t-.425-1.075T9.5 6t-1.075.425T8 7.5t.425 1.075T9.5 9m5 0q.65 0 1.075-.425T16 7.5t-.425-1.075T14.5 6t-1.075.425T13 7.5t.425 1.075T14.5 9m3 4q.65 0 1.075-.425T19 11.5t-.425-1.075T17.5 10t-1.075.425T16 11.5t.425 1.075T17.5 13M12 20q.225 0 .363-.125t.137-.325q0-.35-.375-.825T11.75 17.3q0-1.05.725-1.675T14.25 15H16q1.65 0 2.825-.962T20 11.05q0-3.025-2.312-5.038T12.2 4Q8.8 4 6.4 6.325T4 12q0 3.325 2.338 5.663T12 20" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:palette-outline></use></svg></button><astro-island await-children="" client=load component-export=default component-url=/_astro/LightDarkSwitch.BNVpgrLB.js opts={&quot;name&quot;:&quot;LightDarkSwitch&quot;,&quot;value&quot;:true} props={} renderer-url=/_astro/client.CWY0IrnN.js ssr="" uid=Z2opMOI><div class="relative z-50" role=menu tabindex=-1><button class="rounded-lg btn-plain scale-animation h-11 active:scale-90 w-11 relative" aria-label="Light/Dark Mode" id=scheme-switch role=menuitem><div class="absolute opacity-0"></div><div class="absolute opacity-0"></div><div class=absolute></div></button><div class="transition absolute hidden lg:block -right-2 float-panel-closed pt-5 top-11" id=light-dark-panel><div class="card-base float-panel p-2"><button class="flex items-center rounded-lg transition active:scale-95 btn-plain font-medium h-9 justify-start px-3 scale-animation w-full whitespace-nowrap mb-0.5">亮色</button> <button class="flex items-center rounded-lg transition active:scale-95 btn-plain font-medium h-9 justify-start px-3 scale-animation w-full whitespace-nowrap mb-0.5">暗色</button> <button class="flex items-center rounded-lg transition active:scale-95 btn-plain font-medium h-9 justify-start px-3 scale-animation w-full whitespace-nowrap current-theme-btn">跟随系统</button></div></div></div><!--astro:end--></astro-island><button class="rounded-lg btn-plain scale-animation h-11 active:scale-90 w-11 md:hidden" aria-label=Menu id=nav-menu-switch name="Nav Menu"><svg data-icon=material-symbols:menu-rounded height=1em viewBox="0 0 24 24" width=1em class=text-[1.25rem]><symbol id=ai:material-symbols:menu-rounded><path d="M4 18q-.425 0-.712-.288T3 17t.288-.712T4 16h16q.425 0 .713.288T21 17t-.288.713T20 18zm0-5q-.425 0-.712-.288T3 12t.288-.712T4 11h16q.425 0 .713.288T21 12t-.288.713T20 13zm0-5q-.425 0-.712-.288T3 7t.288-.712T4 6h16q.425 0 .713.288T21 7t-.288.713T20 8z" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:menu-rounded></use></svg></button></div><div class="absolute float-panel-closed float-panel right-4 fixed px-2 py-2 transition-all" id=nav-menu-panel><a href=/ class="flex items-center rounded-lg transition active:bg-[var(--btn-plain-bg-active)] gap-8 group hover:bg-[var(--btn-plain-bg-hover)] justify-between pl-3 pr-1 py-2"><div class="transition font-bold dark:text-white/75 text-black/75 group-active:text-[var(--primary)] group-hover:text-[var(--primary)]">主页</div><svg data-icon=material-symbols:chevron-right-rounded height=1em viewBox="0 0 24 24" width=1em class="transition text-[var(--primary)] text-[1.25rem]"><use xlink:href=#ai:material-symbols:chevron-right-rounded></use></svg> </a><a href=/archive/ class="flex items-center rounded-lg transition active:bg-[var(--btn-plain-bg-active)] gap-8 group hover:bg-[var(--btn-plain-bg-hover)] justify-between pl-3 pr-1 py-2"><div class="transition font-bold dark:text-white/75 text-black/75 group-active:text-[var(--primary)] group-hover:text-[var(--primary)]">归档</div><svg data-icon=material-symbols:chevron-right-rounded height=1em viewBox="0 0 24 24" width=1em class="transition text-[var(--primary)] text-[1.25rem]"><use xlink:href=#ai:material-symbols:chevron-right-rounded></use></svg> </a><a href=/about/ class="flex items-center rounded-lg transition active:bg-[var(--btn-plain-bg-active)] gap-8 group hover:bg-[var(--btn-plain-bg-hover)] justify-between pl-3 pr-1 py-2"><div class="transition font-bold dark:text-white/75 text-black/75 group-active:text-[var(--primary)] group-hover:text-[var(--primary)]">关于</div><svg data-icon=material-symbols:chevron-right-rounded height=1em viewBox="0 0 24 24" width=1em class="transition text-[var(--primary)] text-[1.25rem]"><use xlink:href=#ai:material-symbols:chevron-right-rounded></use></svg> </a><a href=https://github.com/riyuexingchennnn class="flex items-center rounded-lg transition active:bg-[var(--btn-plain-bg-active)] gap-8 group hover:bg-[var(--btn-plain-bg-hover)] justify-between pl-3 pr-1 py-2" target=_blank><div class="transition font-bold dark:text-white/75 text-black/75 group-active:text-[var(--primary)] group-hover:text-[var(--primary)]">GitHub</div><svg data-icon=fa6-solid:arrow-up-right-from-square height=1em viewBox="0 0 512 512" width=1em class="transition -translate-x-1 dark:text-white/25 text-[0.75rem] text-black/25"><use xlink:href=#ai:fa6-solid:arrow-up-right-from-square></use></svg></a></div><script>(self.Astro||(self.Astro={})).only=async t=>{await(await t())()},window.dispatchEvent(new Event("astro:only"))</script><astro-island await-children="" client=only component-export=default component-url=/_astro/DisplaySettings.CnEoRlSJ.js opts={&quot;name&quot;:&quot;DisplaySettings&quot;,&quot;value&quot;:&quot;svelte&quot;} props={} renderer-url=/_astro/client.CWY0IrnN.js ssr="" uid=ZqEiEp><template data-astro-template=restore-icon><svg data-icon=fa6-solid:arrow-rotate-left height=1em viewBox="0 0 512 512" width=1em class=text-[0.875rem] slot=restore-icon><symbol id=ai:fa6-solid:arrow-rotate-left><path d="M125.7 160H176c17.7 0 32 14.3 32 32s-14.3 32-32 32H48c-17.7 0-32-14.3-32-32V64c0-17.7 14.3-32 32-32s32 14.3 32 32v51.2l17.6-17.6c87.5-87.5 229.3-87.5 316.8 0s87.5 229.3 0 316.8s-229.3 87.5-316.8 0c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0c62.5 62.5 163.8 62.5 226.3 0s62.5-163.8 0-226.3s-163.8-62.5-226.3 0z" fill=currentColor /></symbol><use xlink:href=#ai:fa6-solid:arrow-rotate-left></use></svg></template><!--astro:end--></astro-island></div></div><script>!async function(){const i=await import("/pagefind/pagefind.js");await i.options({excerptLength:20}),i.init(),window.pagefind=i,i.search("")}()</script></div></div><div class="absolute pointer-events-none w-full z-30" style=top:5.5rem><div class="mx-auto relative max-w-[var(--page-width)] pointer-events-auto"><div class="transition w-full duration-700 gap-4 grid grid-cols-[17.5rem_auto] grid-rows-[auto_1fr_auto] left-0 lg:grid-rows-[auto] md:px-4 mx-auto px-0 right-0" id=main-grid><div class="onload-animation col-span-2 lg:col-span-1 lg:max-w-[17.5rem] lg:row-end-2 lg:row-start-1 mb-4 row-end-3 row-start-2 w-full" id=sidebar><div class="flex flex-col gap-4 w-full mb-4"><div class="card-base p-3"><a href=/about/ class="overflow-hidden relative rounded-xl active:scale-95 block group lg:max-w-none lg:mt-0 lg:mx-0 max-w-[240px] mb-3 mt-1 mx-auto" aria-label="Go to About Page"><div class="flex items-center justify-center transition absolute group-active:bg-black/50 group-hover:bg-black/30 h-full pointer-events-none w-full z-50"><svg data-icon=fa6-regular:address-card height=1em viewBox="0 0 576 512" width=1.13em class="transition group-hover:opacity-100 group-hover:scale-100 opacity-0 scale-90 text-5xl text-white"><symbol id=ai:fa6-regular:address-card><path d="M512 80c8.8 0 16 7.2 16 16v320c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V96c0-8.8 7.2-16 16-16zM64 32C28.7 32 0 60.7 0 96v320c0 35.3 28.7 64 64 64h448c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64zm144 224a64 64 0 1 0 0-128a64 64 0 1 0 0 128m-32 32c-44.2 0-80 35.8-80 80c0 8.8 7.2 16 16 16h192c8.8 0 16-7.2 16-16c0-44.2-35.8-80-80-80zm200-144c-13.3 0-24 10.7-24 24s10.7 24 24 24h80c13.3 0 24-10.7 24-24s-10.7-24-24-24zm0 96c-13.3 0-24 10.7-24 24s10.7 24 24 24h80c13.3 0 24-10.7 24-24s-10.7-24-24-24z" fill=currentColor /></symbol><use xlink:href=#ai:fa6-regular:address-card></use></svg></div><div class="overflow-hidden relative lg:mt-0 mx-auto h-full lg:w-full"><div class="transition absolute pointer-events-none bg-opacity-50 dark:bg-black/10 inset-0"></div><img alt="Profile Image of the Author" decoding=async height=576 loading=lazy src=/_astro/avatar.CPRSuycf_ZLFGbl.webp width=576 class="object-cover h-full w-full" style=object-position:center></div></a><div class=px-2><div class="transition font-bold dark:text-neutral-50 mb-1 text-center text-xl">日月星辰</div><div class="transition mb-2 bg-[var(--primary)] h-1 mx-auto rounded-full w-5"></div><div class="transition text-center mb-2.5 text-neutral-400">一个不想拯救世界的技术宅</div><div class="flex mb-1 gap-2 justify-center"><a href="" class="rounded-lg active:scale-90 btn-regular h-10 w-10" target=_blank aria-label=Twitter rel=me><svg data-icon=fa6-brands:twitter height=1em viewBox="0 0 512 512" width=1em class=text-[1.5rem]><symbol id=ai:fa6-brands:twitter><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645c0 138.72-105.583 298.558-298.558 298.558c-59.452 0-114.68-17.219-161.137-47.106c8.447.974 16.568 1.299 25.34 1.299c49.055 0 94.213-16.568 130.274-44.832c-46.132-.975-84.792-31.188-98.112-72.772c6.498.974 12.995 1.624 19.818 1.624c9.421 0 18.843-1.3 27.614-3.573c-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319c-28.264-18.843-46.781-51.005-46.781-87.391c0-19.492 5.197-37.36 14.294-52.954c51.655 63.675 129.3 105.258 216.365 109.807c-1.624-7.797-2.599-15.918-2.599-24.04c0-57.828 46.782-104.934 104.934-104.934c30.213 0 57.502 12.67 76.67 33.137c23.715-4.548 46.456-13.32 66.599-25.34c-7.798 24.366-24.366 44.833-46.132 57.827c21.117-2.273 41.584-8.122 60.426-16.243c-14.292 20.791-32.161 39.308-52.628 54.253" fill=currentColor /></symbol><use xlink:href=#ai:fa6-brands:twitter></use></svg> </a><a href="" class="rounded-lg active:scale-90 btn-regular h-10 w-10" target=_blank aria-label=Steam rel=me><svg data-icon=fa6-brands:steam height=1em viewBox="0 0 496 512" width=0.97em class=text-[1.5rem]><symbol id=ai:fa6-brands:steam><path d="M496 256c0 137-111.2 248-248.4 248c-113.8 0-209.6-76.3-239-180.4l95.2 39.3c6.4 32.1 34.9 56.4 68.9 56.4c39.2 0 71.9-32.4 70.2-73.5l84.5-60.2c52.1 1.3 95.8-40.9 95.8-93.5c0-51.6-42-93.5-93.7-93.5s-93.7 42-93.7 93.5v1.2L176.6 279c-15.5-.9-30.7 3.4-43.5 12.1L0 236.1C10.2 108.4 117.1 8 247.6 8C384.8 8 496 119 496 256M155.7 384.3l-30.5-12.6a52.8 52.8 0 0 0 27.2 25.8c26.9 11.2 57.8-1.6 69-28.4c5.4-13 5.5-27.3.1-40.3S206 305.6 193 300.2c-12.9-5.4-26.7-5.2-38.9-.6l31.5 13c19.8 8.2 29.2 30.9 20.9 50.7c-8.3 19.9-31 29.2-50.8 21m173.8-129.9c-34.4 0-62.4-28-62.4-62.3s28-62.3 62.4-62.3s62.4 28 62.4 62.3s-27.9 62.3-62.4 62.3m.1-15.6c25.9 0 46.9-21 46.9-46.8c0-25.9-21-46.8-46.9-46.8s-46.9 21-46.9 46.8c.1 25.8 21.1 46.8 46.9 46.8" fill=currentColor /></symbol><use xlink:href=#ai:fa6-brands:steam></use></svg> </a><a href=https://github.com/riyuexingchennnn class="rounded-lg active:scale-90 btn-regular h-10 w-10" target=_blank aria-label=GitHub rel=me><svg data-icon=fa6-brands:github height=1em viewBox="0 0 496 512" width=0.97em class=text-[1.5rem]><symbol id=ai:fa6-brands:github><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6c-3.3.3-5.6-1.3-5.6-3.6c0-2 2.3-3.6 5.2-3.6c3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9c2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9c.3 2 2.9 3.3 5.9 2.6c2.9-.7 4.9-2.6 4.6-4.6c-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2c12.8 2.3 17.3-5.6 17.3-12.1c0-6.2-.3-40.4-.3-61.4c0 0-70 15-84.7-29.8c0 0-11.4-29.1-27.8-36.6c0 0-22.9-15.7 1.6-15.4c0 0 24.9 2 38.6 25.8c21.9 38.6 58.6 27.5 72.9 20.9c2.3-16 8.8-27.1 16-33.7c-55.9-6.2-112.3-14.3-112.3-110.5c0-27.5 7.6-41.3 23.6-58.9c-2.6-6.5-11.1-33.3 2.6-67.9c20.9-6.5 69 27 69 27c20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27c13.7 34.7 5.2 61.4 2.6 67.9c16 17.7 25.8 31.5 25.8 58.9c0 96.5-58.9 104.2-114.8 110.5c9.2 7.9 17 22.9 17 46.4c0 33.7-.3 75.4-.3 83.6c0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252C496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2c1.6 1.6 3.9 2.3 5.2 1c1.3-1 1-3.3-.7-5.2c-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9c1.6 1 3.6.7 4.3-.7c.7-1.3-.3-2.9-2.3-3.9c-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2c2.3 2.3 5.2 2.6 6.5 1c1.3-1.3.7-4.3-1.3-6.2c-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2c-1.4-2.3-4-3.3-5.6-2" fill=currentColor /></symbol><use xlink:href=#ai:fa6-brands:github></use></svg></a></div></div></div></div><div class="flex flex-col gap-4 w-full top-4 top-4 duration-700 sticky transition-all" id=sidebar-sticky><widget-layout class="onload-animation card-base pb-4" data-astro-cid-ucso7hve data-id=categories data-is-collapsed=false style=animation-delay:150ms;--collapsedHeight:7.5rem><div class="transition font-bold before:absolute before:bg-[var(--primary)] before:rounded-md before:h-4 before:left-[-16px] before:top-[5.5px] before:w-1 dark:text-neutral-100 mb-2 ml-8 mt-4 relative text-lg text-neutral-900" style=--collapsedHeight:7.5rem data-astro-cid-ucso7hve>分类</div><div class="overflow-hidden collapse-wrapper px-4" id=categories style=--collapsedHeight:7.5rem data-astro-cid-ucso7hve><a href=/archive/category/培训/ aria-label="View all posts in the 培训 category"><button class="rounded-lg active:bg-[var(--btn-plain-bg-active)] hover:bg-[var(--btn-plain-bg-hover)] bg-none dark:hover:text-[var(--primary)] dark:text-neutral-300 h-10 hover:pl-3 hover:text-[var(--primary)] pl-2 text-neutral-700 transition-all w-full"><div class="flex items-center relative justify-between mr-2"><div class="overflow-hidden overflow-ellipsis whitespace-nowrap text-left">培训</div><div class="flex items-center rounded-lg font-bold justify-center ml-4 bg-[oklch(0.95_0.025_var(--hue))] dark:bg-[var(--primary)] dark:text-[var(--deep-text)] h-7 min-w-[2rem] text-[var(--btn-content)] text-sm transition">2</div></div></button></a></div></widget-layout><widget-layout class="onload-animation card-base pb-4" data-astro-cid-ucso7hve data-id=tags data-is-collapsed=false style=animation-delay:.2s;--collapsedHeight:7.5rem><div class="transition font-bold before:absolute before:bg-[var(--primary)] before:rounded-md before:h-4 before:left-[-16px] before:top-[5.5px] before:w-1 dark:text-neutral-100 mb-2 ml-8 mt-4 relative text-lg text-neutral-900" style=--collapsedHeight:7.5rem data-astro-cid-ucso7hve>标签</div><div class="overflow-hidden collapse-wrapper px-4" id=tags style=--collapsedHeight:7.5rem data-astro-cid-ucso7hve><div class="flex flex-wrap gap-2"><a href=/archive/tag/深度学习/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the 深度学习 tag">深度学习</a></div></div></widget-layout></div></div><main class="overflow-hidden col-span-2 lg:col-span-1 transition-swup-fade" id=swup-container><div class=onload-animation id=content-wrapper><div class="flex relative w-full mb-4 overflow-hidden rounded-[var(--radius-large)]"><div class="card-base pb-4 md:px-9 pt-6 px-6 relative w-full z-10" id=post-container><div class="flex transition dark:text-white/30 flex-row gap-5 mb-3 onload-animation text-black/30"><div class="flex items-center flex-row"><div class="flex items-center justify-center transition bg-black/5 dark:bg-white/10 dark:text-white/50 h-6 mr-2 rounded-md text-black/50 w-6"><svg data-icon=material-symbols:notes-rounded height=1em viewBox="0 0 24 24" width=1em><symbol id=ai:material-symbols:notes-rounded><path d="M4 18q-.425 0-.712-.288T3 17t.288-.712T4 16h10q.425 0 .713.288T15 17t-.288.713T14 18zm0-5q-.425 0-.712-.288T3 12t.288-.712T4 11h16q.425 0 .713.288T21 12t-.288.713T20 13zm0-5q-.425 0-.712-.288T3 7t.288-.712T4 6h16q.425 0 .713.288T21 7t-.288.713T20 8z" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:notes-rounded></use></svg></div><div class=text-sm>6809 字</div></div><div class="flex items-center flex-row"><div class="flex items-center justify-center transition bg-black/5 dark:bg-white/10 dark:text-white/50 h-6 mr-2 rounded-md text-black/50 w-6"><svg data-icon=material-symbols:schedule-outline-rounded height=1em viewBox="0 0 24 24" width=1em><symbol id=ai:material-symbols:schedule-outline-rounded><path d="M13 11.6V8q0-.425-.288-.712T12 7t-.712.288T11 8v3.975q0 .2.075.388t.225.337l3.3 3.3q.275.275.7.275T16 16t.275-.7t-.275-.7zM12 22q-2.075 0-3.9-.788t-3.175-2.137T2.788 15.9T2 12t.788-3.9t2.137-3.175T8.1 2.788T12 2t3.9.788t3.175 2.137T21.213 8.1T22 12t-.788 3.9t-2.137 3.175t-3.175 2.138T12 22m0-2q3.325 0 5.663-2.337T20 12t-2.337-5.663T12 4T6.337 6.338T4 12t2.338 5.663T12 20" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:schedule-outline-rounded></use></svg></div><div class=text-sm>34 分钟</div></div></div><div class="onload-animation relative"><div class="transition w-full before:absolute before:bg-[var(--primary)] before:h-5 before:left-[-1.125rem] before:rounded-md before:top-[0.75rem] block dark:text-white/90 font-bold mb-3 md:before:w-1 md:text-[2.25rem]/[2.75rem] text-3xl text-black/90" data-pagefind-body data-pagefind-meta=title data-pagefind-weight=10>深度学习基础</div></div><div class=onload-animation><div class="flex items-center gap-4 dark:text-neutral-400 flex-wrap gap-x-4 gap-y-2 mb-5 text-neutral-500"><div class="flex items-center"><div class=meta-icon><svg data-icon=material-symbols:calendar-today-outline-rounded height=1em viewBox="0 0 24 24" width=1em class=text-xl><symbol id=ai:material-symbols:calendar-today-outline-rounded><path d="M5 22q-.825 0-1.412-.587T3 20V6q0-.825.588-1.412T5 4h1V3q0-.425.288-.712T7 2t.713.288T8 3v1h8V3q0-.425.288-.712T17 2t.713.288T18 3v1h1q.825 0 1.413.588T21 6v14q0 .825-.587 1.413T19 22zm0-2h14V10H5zM5 8h14V6H5zm0 0V6z" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:calendar-today-outline-rounded></use></svg></div><span class="text-sm text-50 font-medium">2024-11-27</span></div><div class="flex items-center"><div class=meta-icon><svg data-icon=material-symbols:book-2-outline-rounded height=1em viewBox="0 0 24 24" width=1em class=text-xl><symbol id=ai:material-symbols:book-2-outline-rounded><path d="M6 15.325q.35-.175.725-.25T7.5 15H8V4h-.5q-.625 0-1.062.438T6 5.5zM10 15h8V4h-8zm-4 .325V4zM7.5 22q-1.45 0-2.475-1.025T4 18.5v-13q0-1.45 1.025-2.475T7.5 2H18q.825 0 1.413.587T20 4v12.525q0 .2-.162.363t-.588.362q-.35.175-.55.5t-.2.75t.2.763t.55.487t.55.413t.2.562v.25q0 .425-.288.725T19 22zm0-2h9.325q-.15-.35-.237-.712T16.5 18.5q0-.4.075-.775t.25-.725H7.5q-.65 0-1.075.438T6 18.5q0 .65.425 1.075T7.5 20" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:book-2-outline-rounded></use></svg></div><div class="flex items-center flex-row flex-nowrap"><a href=/archive/category/培训/ class="transition font-medium whitespace-nowrap dark:hover:text-[var(--primary)] hover:text-[var(--primary)] link-lg text-50 text-sm" aria-label="View all posts in the 培训 category">培训</a></div></div><div class="flex items-center"><div class=meta-icon><svg data-icon=material-symbols:tag-rounded height=1em viewBox="0 0 24 24" width=1em class=text-xl><symbol id=ai:material-symbols:tag-rounded><path d="m9 16l-.825 3.275q-.075.325-.325.525t-.6.2q-.475 0-.775-.375T6.3 18.8L7 16H4.275q-.5 0-.8-.387T3.3 14.75q.075-.35.35-.55t.625-.2H7.5l1-4H5.775q-.5 0-.8-.387T4.8 8.75q.075-.35.35-.55t.625-.2H9l.825-3.275Q9.9 4.4 10.15 4.2t.6-.2q.475 0 .775.375t.175.825L11 8h4l.825-3.275q.075-.325.325-.525t.6-.2q.475 0 .775.375t.175.825L17 8h2.725q.5 0 .8.387t.175.863q-.075.35-.35.55t-.625.2H16.5l-1 4h2.725q.5 0 .8.388t.175.862q-.075.35-.35.55t-.625.2H15l-.825 3.275q-.075.325-.325.525t-.6.2q-.475 0-.775-.375T12.3 18.8L13 16zm.5-2h4l1-4h-4z" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:tag-rounded></use></svg></div><div class="flex items-center flex-row flex-nowrap"><div class="text-sm hidden mx-1.5 text-[var(--meta-divider)]">/</div><a href=/archive/tag/深度学习/ class="transition font-medium whitespace-nowrap dark:hover:text-[var(--primary)] hover:text-[var(--primary)] link-lg text-50 text-sm" aria-label="View all posts with the 深度学习 tag">深度学习</a></div></div></div></div><div class="overflow-hidden relative rounded-xl onload-animation banner-container mb-8" id=post-cover><div class="transition absolute pointer-events-none bg-opacity-50 dark:bg-black/10 inset-0"></div><img alt="" decoding=async height=395 loading=lazy src=/_astro/17.Bs_Ig4Bw_Z2bNY4A.webp width=693 class="object-cover h-full w-full" style=object-position:center></div><div class="onload-animation mb-6 !max-w-none custom-md dark:prose-invert markdown-content prose prose-base" data-pagefind-body><h1 id=前言>前言<a href=#前言 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h1><p>FYT视觉组培训，针对RoboMaster的深度学习速成课。</p><p>预备知识：</p><ul><li>学习完前面的C++培训知识，有基本的编程能力。</li><li>掌握Python的基本语法。</li></ul><p>参考书籍：</p><ul><li>Deep Learning with Python Second Edition (主要讲tensorflow)</li><li>DIVE INTO DEEP LEARNING (主要讲pytorch)</li><li>了解CV与RoboMaster视觉组 (视觉组圣经)</li></ul><p>往年的深度学习文档：<a href=https://github.com/CSU-FYT-Vision/Vision-Tutorial>https://github.com/CSU-FYT-Vision/Vision-Tutorial</a></p><p>讲解人</p><blockquote><p>计科2205 蔡明辰</p></blockquote><hr><h1 id=1-初识深度学习>1. 初识深度学习<a href=#1-初识深度学习 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h1><h2 id=11-什么是深度学习>1.1 什么是深度学习<a href=#11-什么是深度学习 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><p>深度学习（Deep Learning）是<strong>机器学习</strong>的一种方法，它利用多层<strong>神经网络</strong>对数据进行学习，并通过<strong>反向传播</strong>算法进行<strong>梯度下降</strong>，从而使得神经网络能够自动学习到数据的特征，并对未知数据进行<strong>预测</strong>。</p><h2 id=12-robomaster与深度学习>1.2 RoboMaster与深度学习<a href=#12-robomaster与深度学习 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><p>在RoboMaster中，有许多需要使用到深度学习的地方，如图像识别、目标检测等。</p><ul><li>装甲板检测：可以使用实时目标检测装甲板的位置，准确有效击打装甲板。</li><li>装甲数字识别：使用一个简单的图像分类网络，识别数字。</li><li>雷达：目标检测赛场上的各种敌我车辆，显示小地图，发动易伤buff。</li></ul><p>所以RMer视觉也要掌握深度学习的基本知识。</p><h2 id=13-机器学习与深度学习>1.3 机器学习与深度学习<a href=#13-机器学习与深度学习 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><h3 id=131-机器学习>1.3.1 机器学习<a href=#131-机器学习 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h3><p>机器学习的主要任务是从数据中学习，并利用这些知识对未知数据进行预测或决策。机器学习的算法有<strong>监督学习</strong>、<strong>无监督学习</strong>、<strong>半监督学习</strong>、<strong>强化学习</strong>等。</p><ul><li>输入数据。机器学习的输入数据可以是图像、文本、声音、视频等。</li><li>预期输出示例。机器学习的预期输出可以是分类、回归、聚类、排序等。</li><li>衡量算法效果的方法。衡量结果是一种反馈信号，用于调整算法。这个调整的步骤就是我们说的<strong>学习</strong>。</li></ul><p><img alt="" decoding=async height=359 loading=lazy src=/_astro/1.7lzaILPB_Z1igjlI.webp width=929></p><p>机器学习和深度学习的核心问题在于有意义地变换数据。换句话说，在于学习输入数据的有用表示——这种表示可以让数据更接近预期输出。</p><p>了解了<strong>学习</strong>的概念后，看看深度学习的特别之处。</p><h3 id=132-深度学习之深度>1.3.2 深度学习之“深度”<a href=#132-深度学习之深度 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h3><p>深度学习是机器学习的一个分支，它利用多层神经网络对数据进行学习。</p><p><img alt="" decoding=async height=315 loading=lazy src=/_astro/2.BBlbMT2H_Z1xLRmO.webp width=783></p><p>可以将深度神经网络看做一个多级的<strong>信息蒸馏</strong>：信息穿过多层过滤器，其纯度越来越高。</p><h2 id=14-机器学习算法>1.4 机器学习算法<a href=#14-机器学习算法 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><blockquote><p>本小节了解即可。</p></blockquote><h3 id=141-监督学习>1.4.1 监督学习<a href=#141-监督学习 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h3><p><strong>监督学习</strong>擅长在“给定输入特征”的情况下预测标签。</p><p>监督学习的学习过程一般可以分为三大步骤：</p><ol><li><p>从已知大量数据样本中随机选取一个子集，为每个样本获取真实标签。有时，这些样本已有标签（例如，患者是否在下一年内康复？）；有时，这些样本可能需要被人工标记（例如，图像分类）。这些输入和相应的标签一起构成了训练数据集；</p></li><li><p>选择有监督的学习算法，它将训练数据集作为输入，并输出一个“已完成学习的模型”；</p></li><li><p>将之前没有见过的样本特征放到这个“已完成学习的模型”中（测试集），使用模型的输出作为相应标签的预测。</p></li></ol><p><img alt="" decoding=async height=275 loading=lazy src=/_astro/9.D5y6DWWX_ZN11VK.webp width=832></p><ul><li><p><strong>回归</strong>问题：输出是数值类型</p><p>举例：通过各种影响因素预测房价、预测用户对一部电影的评分可以被归类为一个回归问题</p></li><li><p><strong>分类</strong>问题：输出是类别的分类问题的常见损失函数被称为 <strong>交叉熵</strong> （cross-entropy）</p><p>举例：从手写数据集中区分0~9（类别问题）、以下图片是否是毒蘑菇（二分类问题）</p></li></ul><p><img alt="" decoding=async height=447 loading=lazy src=/_astro/10.DYpUJqWs_ZvVE7O.webp width=408></p><p>模型通常给出的是一个概率：比如输入以上蘑菇，分类器可能输出0.8 可以这样理解：分类器90%确定图像描绘的是一只猫</p><h3 id=142-无监督学习>1.4.2 无监督学习<a href=#142-无监督学习 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h3><p>监督学习要向模型提供巨大数据集：每个样本包含特征和相应标签值。</p><p>相反，如果工作没有十分具体的目标，就需要“自发”地去学习了。 比如，老板可能会给我们一大堆数据，然后要求用它做一些数据科学研究，却没有对结果有要求。 这类数据中不含有“目标”的机器学习问题通常被为 <strong>无监督学习</strong>（unsupervised learning）</p><ul><li><p>聚类 （clustering）问题：没有标签的情况下，我们是否能给数据分类呢？比如，给定一组照片，我们能把它们分成风景照片、狗、婴儿、猫和山峰的照片吗？同样，给定一组用户的网页浏览记录，我们能否将具有相似行为的用户聚类呢？</p></li><li><p>主成分分析 （principal component analysis）问题：我们能否找到少量的参数来准确地捕捉数据的线性相关属性？比如，一个球的运动轨迹可以用球的速度、直径和质量来描述。再比如，裁缝们已经开发出了一小部分参数，这些参数相当准确地描述了人体的形状，以适应衣服的需要。另一个例子：在欧几里得空间中是否存在一种（任意结构的）对象的表示，使其符号属性能够很好地匹配?这可以用来描述实体及其关系，例如“罗马” − “意大利” + “法国” = “巴黎”。</p></li><li><p>因果关系 （causality）和 概率图模型 （probabilistic graphical models）问题：我们能否描述观察到的许多数据的根本原因？例如，如果我们有关于房价、污染、犯罪、地理位置、教育和工资的人口统计数据，我们能否简单地根据经验数据发现它们之间的关系？</p></li><li><p>生成对抗性网络 （generative adversarial networks）：为我们提供一种合成数据的方法，甚至像图像和音频这样复杂的非结构化数据。潜在的统计机制是检查真实和虚假数据是否相同的测试，它是无监督学习的另一个重要而令人兴奋的领域。</p></li></ul><h3 id=143-半监督学习>1.4.3 半监督学习<a href=#143-半监督学习 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h3><p>半监督学习（Semi-Supervised Learning, SSL）是一种介于监督学习和无监督学习之间的机器学习方法。它利用少量标注数据和大量未标注数据共同训练模型，目标是提高模型的性能，同时减少对标注数据的依赖。半监督学习方法在标注数据获取成本较高或数据标注较困难的场景中非常有用，例如医学影像分析、自然语言处理和计算机视觉等领域。</p><ul><li>标记样本少的类别：可以用聚类算法来标记样本少的类别。</li><li>标记样本多的类别：可以用生成模型来标记样本多的类别。</li></ul><h3 id=144-强化学习>1.4.4 强化学习<a href=#144-强化学习 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h3><p>强化学习（Reinforcement Learning）是机器学习的一种方法，它通过与环境的互动来学习。</p><p>强化学习的目标是产生一个好的 <strong>策略</strong> （policy）。</p><p>模型根据对环境的观察产生一定的动作，将这个动作应用到环境当中，模型从环境中获得 <strong>奖励</strong></p><p>举例：AlphaGo</p><p><a href="https://www.bilibili.com/video/BV1xn4y1R7GQ/?share_source=copy_web&#x26;vd_source=e4838a460d5e965db0426ab9bd050b56">本科毕设 非嵌入式离线强化学习制作皇室战争AI与8000分人机的获胜对局</a></p><h2 id=14-用三张图理解深度学习的工作原理>1.4 用三张图理解深度学习的工作原理<a href=#14-用三张图理解深度学习的工作原理 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><p><img alt="" decoding=async height=424 loading=lazy src=/_astro/3.Ybx8jjR6_1Og6ex.webp width=705></p><p><img alt="" decoding=async height=605 loading=lazy src=/_astro/4.O3nos9mZ_Z7helQ.webp width=1290></p><h2 id=15-深度学习的硬件>1.5 深度学习的硬件<a href=#15-深度学习的硬件 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><p>CPU、GPU、TPU(张量处理器)</p><p><a href="https://www.bilibili.com/video/BV1xE421j7Uv/?share_source=copy_web&#x26;vd_source=e4838a460d5e965db0426ab9bd050b56">【硬核科普】从零开始认识显卡</a></p><p>2007年，NVIDIA推出了CUDA，它是一种基于GPU的并行编程模型，可以让程序员编写并行代码，并在GPU上运行。</p><h2 id=16-深度学习的历史与发展>1.6 深度学习的历史与发展<a href=#16-深度学习的历史与发展 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><h3 id=161-神经网络的核心关键原则>1.6.1 神经网络的核心关键原则：<a href=#161-神经网络的核心关键原则 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h3><ol><li><strong>线性和非线性处理单元的交替</strong><br>通常称为层（layers）。</li><li><strong>使用链式规则（也称为反向传播 Backpropagation）</strong><br>一次性调整网络中的全部参数。</li></ol><h3 id=162深度学习的提出历史>1.6.2深度学习的提出历史：<a href=#162深度学习的提出历史 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h3><ul><li>一些中流砥柱的模型：<ul><li>多层感知机（McCulloch and Pitts, 1943）</li><li>卷积神经网络（LeCun et al., 1998）</li><li>长短期记忆网络（Graves and Schmidhuber, 2005）</li><li>Q学习（Watkins and Dayan, 1992）</li></ul></li><li>曾因对休眠期和当时技术限制被搁置一段时间后，过去十年被重新发现。</li></ul><h3 id=163-为什么最近十几年深度学习才重新热门>1.6.3 为什么最近十几年深度学习才重新“热门”？<a href=#163-为什么最近十几年深度学习才重新热门 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h3><ol><li><strong>网络和图像传感器的发展使得数据的获取变得廉价</strong><ul><li>大量图片、视频和用户数据信息使得大规模数据集变得触手可及。</li></ul></li><li><strong>运算设备的算力发展</strong><ul><li>GPU的普及，使大规模算力唾手可得。</li></ul></li><li><strong>深度学习框架在传播想法方面发挥了至关重要的作用</strong><ul><li>例如，PyTorch 和 TensorFlow。</li><li>在2014年之前，对卡内基梅隆大学机器学习博士生来说，训练全性能回归模型曾是一个复杂的作业问题。而现在，这项任务只需不到10行代码即可完成。</li></ul></li></ol><h1 id=2-神经网络的基本数学概念>2. 神经网络的基本数学概念<a href=#2-神经网络的基本数学概念 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h1><h2 id=21-张量-tensor-介绍>2.1 张量 (Tensor) 介绍<a href=#21-张量-tensor-介绍 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><p>张量是多维数组的泛化，用于表示标量、向量、矩阵及更高维数据。</p><ol><li><p><strong>标量 (Scalar)</strong><br>标量是零维张量，仅表示一个数值，例如：</p><pre class="astro-code github-dark" data-language=python style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#e1e4e8>x </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> np.array(</span><span style=color:#79b8ff>5</span><span style=color:#e1e4e8>)  </span><span style=color:#6a737d># 标量</span></span>
<span class=line></span></code></pre></li><li><p><strong>向量 (Vector)</strong><br>向量是一维张量，例如：</p><pre class="astro-code github-dark" data-language=python style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#e1e4e8>x </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> np.array([</span><span style=color:#79b8ff>1</span><span style=color:#e1e4e8>, </span><span style=color:#79b8ff>2</span><span style=color:#e1e4e8>, </span><span style=color:#79b8ff>3</span><span style=color:#e1e4e8>])  </span><span style=color:#6a737d># 向量</span></span>
<span class=line></span></code></pre></li><li><p><strong>矩阵 (Matrix)</strong><br>矩阵是二维张量，例如：</p><pre class="astro-code github-dark" data-language=python style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#e1e4e8>x </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> np.array([[</span><span style=color:#79b8ff>1</span><span style=color:#e1e4e8>, </span><span style=color:#79b8ff>2</span><span style=color:#e1e4e8>], [</span><span style=color:#79b8ff>3</span><span style=color:#e1e4e8>, </span><span style=color:#79b8ff>4</span><span style=color:#e1e4e8>]])  </span><span style=color:#6a737d># 矩阵</span></span>
<span class=line></span></code></pre></li><li><p><strong>张量 (Tensor)</strong><br>张量是更高维度的数组</p></li></ol><h2 id=22-张量运算的导数梯度-gradient>2.2 张量运算的导数——梯度 (Gradient)<a href=#22-张量运算的导数梯度-gradient class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><p>导数这一概念可以应用于任意函数，只要函数所对应的表面是连续且光滑的。张量运算（或张量函数）的导数叫作梯度（gradient）。梯度就是将导数这一概念推广到以张量为输入的函数，张量函数的梯度表示该函数所对应多维表面的曲率（curvature）。</p><h2 id=23-链式求导chain-rule>2.3 链式求导（Chain Rule）<a href=#23-链式求导chain-rule class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><p>链式求导是神经网络梯度计算的核心工具，用于计算复合函数的导数。</p><p>如果函数 <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>z</mi><mo>=</mo><mi>f</mi><mo stretchy=false>(</mo><mi>g</mi><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>z = f(g(x))</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.04398em>z</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathnormal" style=margin-right:.10764em>f</span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:.03588em>g</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>))</span></span></span></span>，则导数计算为：</p><span class=katex-display><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML display=block><semantics><mrow><mfrac><mrow><mi mathvariant=normal>∂</mi><mi>z</mi></mrow><mrow><mi mathvariant=normal>∂</mi><mi>x</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant=normal>∂</mi><mi>z</mi></mrow><mrow><mi mathvariant=normal>∂</mi><mi>g</mi></mrow></mfrac><mo>⋅</mo><mfrac><mrow><mi mathvariant=normal>∂</mi><mi>g</mi></mrow><mrow><mi mathvariant=normal>∂</mi><mi>x</mi></mrow></mfrac></mrow><annotation encoding=application/x-tex>\frac{\partial z}{\partial x} = \frac{\partial z}{\partial g} \cdot \frac{\partial g}{\partial x}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:2.0574em;vertical-align:-.686em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.3714em><span style=top:-2.314em><span class=pstrut style=height:3em></span><span class=mord><span class=mord style=margin-right:.05556em>∂</span><span class="mord mathnormal">x</span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.677em><span class=pstrut style=height:3em></span><span class=mord><span class=mord style=margin-right:.05556em>∂</span><span class="mord mathnormal" style=margin-right:.04398em>z</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.686em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:2.2519em;vertical-align:-.8804em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.3714em><span style=top:-2.314em><span class=pstrut style=height:3em></span><span class=mord><span class=mord style=margin-right:.05556em>∂</span><span class="mord mathnormal" style=margin-right:.03588em>g</span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.677em><span class=pstrut style=height:3em></span><span class=mord><span class=mord style=margin-right:.05556em>∂</span><span class="mord mathnormal" style=margin-right:.04398em>z</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.8804em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222em></span></span><span class=base><span class=strut style=height:2.0574em;vertical-align:-.686em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.3714em><span style=top:-2.314em><span class=pstrut style=height:3em></span><span class=mord><span class=mord style=margin-right:.05556em>∂</span><span class="mord mathnormal">x</span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.677em><span class=pstrut style=height:3em></span><span class=mord><span class=mord style=margin-right:.05556em>∂</span><span class="mord mathnormal" style=margin-right:.03588em>g</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.686em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><p>在神经网络中，每一层的输出是上一层的输入，链式求导用于将输出误差逐层反传以更新权重。</p><h2 id=24-随机梯度下降-stochastic-gradient-descent>2.4 随机梯度下降 (Stochastic Gradient Descent)<a href=#24-随机梯度下降-stochastic-gradient-descent class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><p>给定一个可微函数，理论上可以用解析法找到它的最小值，找到所有导数为0的点，然后比较函数在其中哪个点的取值最小。将这一方法应用于神经网络，就是用解析法求出<strong>损失函数</strong>最小值对应的所有权重值。但在实际中，求解析解往往是不可行的。</p><blockquote><p>一个两个参数求解析解还好说，但是神经网络的参数不会少于几千个，而且经常有上千万个。</p></blockquote><p>SGD的步骤：</p><ol><li>抽取训练样本 x 和对应目标 y_true 组成的一个数据批量。</li><li>在 x 上运行模型，得到预测值 y_pred。这一步叫作<strong>前向传播</strong>。</li><li>计算模型在这批数据上的损失值，用于衡量 y_pred 和 y_true 之间的差距。</li><li>计算损失相对于模型参数的梯度。这一步叫作<strong>反向传播</strong>（backward pass）。</li><li>将参数沿着梯度的反方向移动一小步，比如 W -= learning_rate* gradient，从而使这批数据上的损失值减小一些。<strong>学习率</strong>（learning_rate）是一个调节梯度下降“速度”的标量因子。</li></ol><table><thead><tr><th>⼀维损失函数曲线的随机梯度下降</th><th>⼆维损失表⾯的梯度下降</th></tr></thead><tbody><tr><td><img alt="" decoding=async height=350 loading=lazy src=/_astro/11.jum7tecA_Z1yElY5.webp width=403></td><td><img alt="" decoding=async height=405 loading=lazy src=/_astro/12.9MOVTwAU_Z2tB0tX.webp width=648></td></tr></tbody></table><p>如你所见，直观上来看，<code>learning_rate</code> 因子的取值很重要。如果取值太小，那么沿着曲线下降需要很多次迭代，而且可能会陷入局部极小点（鞍点）。如果取值过大，那么更新权重值之后可能会出现在曲线上完全随机的位置。</p><p><img alt="" decoding=async height=325 loading=lazy src=/_astro/13.CPq_pGhs_ZLe8P6.webp width=562></p><blockquote><p>局部最⼩点的解决办法：动量。</p><p>更新参数 w 不仅要考虑当前梯度值，还要考虑上⼀次参数更新。</p><p>w(新) = w(旧) + momentum(动量因⼦) * velocity - learning_rate * gradient</p></blockquote><h2 id=25-反向传播-backpropagation>2.5 反向传播 (Backpropagation)<a href=#25-反向传播-backpropagation class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><p>反向传播是通过<strong>链式法则</strong>计算神经⽹络梯度的算法。</p><p>反向传播的⼯作流程：</p><ol><li>前向传播：从输⼊层到输出层计算⽹络的预测值。</li><li>损失计算：通过损失函数衡量预测值与真实值的误差。</li><li>反向传播：利⽤链式求导从输出层逐层计算梯度。</li><li>参数更新：使⽤优化器更新权重和偏置。</li></ol><h2 id=26-优化器-optimizer>2.6 优化器 (Optimizer)<a href=#26-优化器-optimizer class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><p>优化器是用于最小化损失函数的算法，通过梯度更新神经网络的参数。</p><h3 id=常见优化器>常见优化器<a href=#常见优化器 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h3><ol><li><strong>随机梯度下降 (SGD)</strong></li></ol><ul><li>批量随机梯度下降，随机梯度下降，小批量随机梯度下降</li></ul><ol start=2><li><strong>AdaGrad</strong></li></ol><ul><li>适合处理稀疏数据，但学习率可能逐渐变小。</li></ul><ol start=3><li><strong>RMSProp</strong></li></ol><ul><li>通过均方根调整学习率，适合非平稳目标。</li></ul><ol start=4><li><strong>Adam</strong><br>综合了动量法和 RMSProp：</li></ol><h2 id=27-用计算图看正向传播和反向传播>2.7 用计算图看正向传播和反向传播<a href=#27-用计算图看正向传播和反向传播 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><p><img alt="" decoding=async height=522 loading=lazy src=/_astro/27.DfqDbMU1_Z1EPqhz.webp width=747></p><p>前向传播的过程比较简单，从输入层开始，逐层计算每一层的输出，直到得到最终的预测值。</p><p>“如果反过来看？”</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><img alt="" decoding=async height=737 loading=lazy src=/_astro/28._NubOowc_Z1hnt4y.webp width=870></td><td><img alt="" decoding=async height=787 loading=lazy src=/_astro/29.C0CcZPln_Z1X04FU.webp width=940></td></tr></tbody></table><p>对该图应用<strong>链式法则</strong>，可以计算出我们想要的梯度（损失函数相对于参数的梯度偏导）：</p><ul><li>grad(loss_val,w) = 1 x 1 x 2 = 2</li><li>grad(loss_val,b) = 1 x 1 = 1</li></ul><p>然后，我们就可以用这些梯度来更新参数w和b了。</p><h1 id=3-从线性回归到神经网络>3. 从线性回归到神经网络<a href=#3-从线性回归到神经网络 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h1><h2 id=31-主要目的>3.1 主要目的<a href=#31-主要目的 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><p>学习如何⽤PyTorch编程。</p><h2 id=32-任务目标>3.2 任务目标<a href=#32-任务目标 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><p>线性回归的式⼦满⾜：y = w*x + b，其中w和b均为参数，x，y可以理解成特征值和⽬标值，在程序中我们指定x，w，b，⽬标值y也随之确定了下来。然后将x通过神经⽹络进⾏训练，我们希望通过训练，使得随机初始化的参数w和b能够逼近⼀开始我们指定的w，b，使得预测值pred和实际的⽬标值y能够⽆限接近。</p><h2 id=33-损失函数-loss-function>3.3 损失函数 (Loss Function)<a href=#33-损失函数-loss-function class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><p>损失函数⽤于衡量模型预测值与真实值的差距。通常我们会选择⾮负数作为损失，且数值越⼩表⽰损失越⼩，完美预测时的损失为0。回归问题中最常⽤的损失函数是平⽅误差函数。</p><span class=katex-display><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML display=block><semantics><mrow><msup><mi>l</mi><mrow><mo stretchy=false>(</mo><mi>i</mi><mo stretchy=false>)</mo></mrow></msup><mo stretchy=false>(</mo><mi mathvariant=bold>w</mi><mo separator=true>,</mo><mi>b</mi><mo stretchy=false>)</mo><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msup><mrow><mo fence=true>(</mo><msup><mover accent=true><mi>y</mi><mo>^</mo></mover><mrow><mo stretchy=false>(</mo><mi>i</mi><mo stretchy=false>)</mo></mrow></msup><mo>−</mo><msup><mi>y</mi><mrow><mo stretchy=false>(</mo><mi>i</mi><mo stretchy=false>)</mo></mrow></msup><mo fence=true>)</mo></mrow><mn>2</mn></msup></mrow><annotation encoding=application/x-tex>l^{(i)}(\mathbf{w}, b) = \frac{1}{2} \left( \hat{y}^{(i)} - y^{(i)} \right)^2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.188em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.01968em>l</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.938em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">(</span><span class="mord mathnormal mtight">i</span><span class="mtight mclose">)</span></span></span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathbf" style=margin-right:.01597em>w</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal">b</span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:2.04em;vertical-align:-.686em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.3214em><span style=top:-2.314em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>2</span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.677em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.686em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace style=margin-right:.1667em></span><span class=minner><span class=minner><span class="mopen delimcenter" style=top:0><span class="delimsizing size2">(</span></span><span class=mord><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6944em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal" style=margin-right:.03588em>y</span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1944em><span class=mord>^</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.1944em><span></span></span></span></span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.938em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">(</span><span class="mord mathnormal mtight">i</span><span class="mtight mclose">)</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>y</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.938em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">(</span><span class="mord mathnormal mtight">i</span><span class="mtight mclose">)</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0><span class="delimsizing size2">)</span></span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:1.354em><span style=top:-3.6029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><blockquote><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow><annotation encoding=application/x-tex>\frac{1}{2}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.1901em;vertical-align:-.345em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8451em><span style=top:-2.655em><span class=pstrut style=height:3em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.394em><span class=pstrut style=height:3em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.345em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>并不会带来本质上的区别，只是为了求导简单</p></blockquote><p><img alt="" decoding=async height=363 loading=lazy src=/_astro/16.BqATutIx_1VSv4B.webp width=588></p><p>我们需要计算在训练集n个样本上的损失均值：</p><span class=katex-display><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML display=block><semantics><mrow><mi>L</mi><mo stretchy=false>(</mo><mi mathvariant=bold>w</mi><mo separator=true>,</mo><mi>b</mi><mo stretchy=false>)</mo><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msup><mi>l</mi><mrow><mo stretchy=false>(</mo><mi>i</mi><mo stretchy=false>)</mo></mrow></msup><mo stretchy=false>(</mo><mi mathvariant=bold>w</mi><mo separator=true>,</mo><mi>b</mi><mo stretchy=false>)</mo><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mfrac><mn>1</mn><mn>2</mn></mfrac><msup><mrow><mo fence=true>(</mo><msup><mi mathvariant=bold>w</mi><mi mathvariant=normal>⊤</mi></msup><msup><mi mathvariant=bold>x</mi><mrow><mo stretchy=false>(</mo><mi>i</mi><mo stretchy=false>)</mo></mrow></msup><mo>+</mo><mi>b</mi><mo>−</mo><msup><mi>y</mi><mrow><mo stretchy=false>(</mo><mi>i</mi><mo stretchy=false>)</mo></mrow></msup><mo fence=true>)</mo></mrow><mn>2</mn></msup><mi mathvariant=normal>.</mi></mrow><annotation encoding=application/x-tex>L(\mathbf{w}, b) = \frac{1}{n} \sum_{i=1}^{n} l^{(i)}(\mathbf{w}, b) = \frac{1}{n} \sum_{i=1}^{n} \frac{1}{2} \left( \mathbf{w}^\top \mathbf{x}^{(i)} + b - y^{(i)} \right)^2.</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathnormal">L</span><span class=mopen>(</span><span class="mord mathbf" style=margin-right:.01597em>w</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal">b</span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:2.9291em;vertical-align:-1.2777em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.3214em><span style=top:-2.314em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathnormal">n</span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.677em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.686em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace style=margin-right:.1667em></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.6514em><span style=top:-1.8723em;margin-left:0><span class=pstrut style=height:3.05em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mtight mrel">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.05em><span class=pstrut style=height:3.05em></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style=top:-4.3em;margin-left:0><span class=pstrut style=height:3.05em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.2777em><span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal" style=margin-right:.01968em>l</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.938em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">(</span><span class="mord mathnormal mtight">i</span><span class="mtight mclose">)</span></span></span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathbf" style=margin-right:.01597em>w</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal">b</span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:2.9291em;vertical-align:-1.2777em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.3214em><span style=top:-2.314em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathnormal">n</span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.677em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.686em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace style=margin-right:.1667em></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.6514em><span style=top:-1.8723em;margin-left:0><span class=pstrut style=height:3.05em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mtight mrel">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.05em><span class=pstrut style=height:3.05em></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style=top:-4.3em;margin-left:0><span class=pstrut style=height:3.05em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.2777em><span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.3214em><span style=top:-2.314em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>2</span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.677em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.686em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace style=margin-right:.1667em></span><span class=minner><span class=minner><span class="mopen delimcenter" style=top:0><span class="delimsizing size2">(</span></span><span class=mord><span class="mord mathbf" style=margin-right:.01597em>w</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8991em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class=mord><span class="mord mathbf">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.938em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">(</span><span class="mord mathnormal mtight">i</span><span class="mtight mclose">)</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222em></span><span class="mord mathnormal">b</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>y</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.938em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">(</span><span class="mord mathnormal mtight">i</span><span class="mtight mclose">)</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0><span class="delimsizing size2">)</span></span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:1.354em><span style=top:-3.6029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class=mord>.</span></span></span></span></span><h2 id=34-代码实现>3.4 代码实现<a href=#34-代码实现 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><pre class="astro-code github-dark" data-language=python style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#f97583>import</span><span style=color:#e1e4e8> torch</span></span>
<span class=line><span style=color:#f97583>import</span><span style=color:#e1e4e8> torch.nn </span><span style=color:#f97583>as</span><span style=color:#e1e4e8> nn</span></span>
<span class=line><span style=color:#f97583>import</span><span style=color:#e1e4e8> torch.optim </span><span style=color:#f97583>as</span><span style=color:#e1e4e8> optim</span></span>
<span class=line><span style=color:#f97583>import</span><span style=color:#e1e4e8> matplotlib.pyplot </span><span style=color:#f97583>as</span><span style=color:#e1e4e8> plt</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d># 1. 生成数据</span></span>
<span class=line><span style=color:#6a737d># 创建一些模拟数据，假设 y = 3x + 2 + 噪声</span></span>
<span class=line><span style=color:#e1e4e8>torch.manual_seed(</span><span style=color:#79b8ff>42</span><span style=color:#e1e4e8>)  </span><span style=color:#6a737d># 设置随机种子</span></span>
<span class=line><span style=color:#e1e4e8>x </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> torch.linspace(</span><span style=color:#79b8ff>0</span><span style=color:#e1e4e8>, </span><span style=color:#79b8ff>10</span><span style=color:#e1e4e8>, </span><span style=color:#79b8ff>100</span><span style=color:#e1e4e8>).unsqueeze(</span><span style=color:#79b8ff>1</span><span style=color:#e1e4e8>)  </span><span style=color:#6a737d># 输入数据 (100, 1)</span></span>
<span class=line><span style=color:#e1e4e8>y </span><span style=color:#f97583>=</span><span style=color:#79b8ff> 3</span><span style=color:#f97583> *</span><span style=color:#e1e4e8> x </span><span style=color:#f97583>+</span><span style=color:#79b8ff> 2</span><span style=color:#f97583> +</span><span style=color:#e1e4e8> torch.randn(</span><span style=color:#79b8ff>100</span><span style=color:#e1e4e8>, </span><span style=color:#79b8ff>1</span><span style=color:#e1e4e8>) </span><span style=color:#f97583>*</span><span style=color:#79b8ff> 2</span><span style=color:#6a737d>  # 输出数据带噪声 (100, 1)</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d># 2. 定义一个简单的线性回归模型</span></span>
<span class=line><span style=color:#f97583>class</span><span style=color:#b392f0> LinearRegressionModel</span><span style=color:#e1e4e8>(</span><span style=color:#b392f0>nn</span><span style=color:#e1e4e8>.</span><span style=color:#b392f0>Module</span><span style=color:#e1e4e8>):</span></span>
<span class=line><span style=color:#f97583>    def</span><span style=color:#79b8ff> __init__</span><span style=color:#e1e4e8>(self):</span></span>
<span class=line><span style=color:#79b8ff>        super</span><span style=color:#e1e4e8>(LinearRegressionModel, </span><span style=color:#79b8ff>self</span><span style=color:#e1e4e8>).</span><span style=color:#79b8ff>__init__</span><span style=color:#e1e4e8>()</span></span>
<span class=line><span style=color:#79b8ff>        self</span><span style=color:#e1e4e8>.linear </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> nn.Linear(</span><span style=color:#79b8ff>1</span><span style=color:#e1e4e8>, </span><span style=color:#79b8ff>1</span><span style=color:#e1e4e8>)  </span><span style=color:#6a737d># 输入特征维度1，输出特征维度1</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>    def</span><span style=color:#b392f0> forward</span><span style=color:#e1e4e8>(self, x):</span></span>
<span class=line><span style=color:#f97583>        return</span><span style=color:#79b8ff> self</span><span style=color:#e1e4e8>.linear(x)</span></span>
<span class=line></span>
<span class=line><span style=color:#e1e4e8>model </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> LinearRegressionModel()</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d># 3. 定义损失函数和优化器</span></span>
<span class=line><span style=color:#e1e4e8>criterion </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> nn.MSELoss()  </span><span style=color:#6a737d># 均方误差损失</span></span>
<span class=line><span style=color:#e1e4e8>optimizer </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> optim.SGD(model.parameters(), </span><span style=color:#ffab70>lr</span><span style=color:#f97583>=</span><span style=color:#79b8ff>0.01</span><span style=color:#e1e4e8>)  </span><span style=color:#6a737d># 随机梯度下降优化器</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d># 4. 训练模型</span></span>
<span class=line><span style=color:#e1e4e8>epochs </span><span style=color:#f97583>=</span><span style=color:#79b8ff> 100</span><span style=color:#6a737d>  # 迭代次数</span></span>
<span class=line><span style=color:#e1e4e8>losses </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> []  </span><span style=color:#6a737d># 记录损失</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>for</span><span style=color:#e1e4e8> epoch </span><span style=color:#f97583>in</span><span style=color:#79b8ff> range</span><span style=color:#e1e4e8>(epochs):</span></span>
<span class=line><span style=color:#e1e4e8>    model.train()  </span><span style=color:#6a737d># 设置为训练模式</span></span>
<span class=line><span style=color:#e1e4e8>    optimizer.zero_grad()  </span><span style=color:#6a737d># 清空梯度</span></span>
<span class=line></span>
<span class=line><span style=color:#e1e4e8>    predictions </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> model(x)  </span><span style=color:#6a737d># 模型预测</span></span>
<span class=line><span style=color:#e1e4e8>    loss </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> criterion(predictions, y)  </span><span style=color:#6a737d># 计算损失</span></span>
<span class=line><span style=color:#e1e4e8>    loss.backward()  </span><span style=color:#6a737d># 反向传播计算梯度</span></span>
<span class=line><span style=color:#e1e4e8>    optimizer.step()  </span><span style=color:#6a737d># 更新模型参数</span></span>
<span class=line></span>
<span class=line><span style=color:#e1e4e8>    losses.append(loss.item())  </span><span style=color:#6a737d># 记录损失</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d>    # 每100次输出一次训练信息</span></span>
<span class=line><span style=color:#f97583>    if</span><span style=color:#e1e4e8> (epoch </span><span style=color:#f97583>+</span><span style=color:#79b8ff> 1</span><span style=color:#e1e4e8>) </span><span style=color:#f97583>%</span><span style=color:#79b8ff> 10</span><span style=color:#f97583> ==</span><span style=color:#79b8ff> 0</span><span style=color:#e1e4e8>:</span></span>
<span class=line><span style=color:#79b8ff>        print</span><span style=color:#e1e4e8>(</span><span style=color:#f97583>f</span><span style=color:#9ecbff>"Epoch </span><span style=color:#79b8ff>{</span><span style=color:#e1e4e8>epoch</span><span style=color:#f97583>+</span><span style=color:#79b8ff>1}</span><span style=color:#9ecbff>/</span><span style=color:#79b8ff>{</span><span style=color:#e1e4e8>epochs</span><span style=color:#79b8ff>}</span><span style=color:#9ecbff>, Loss: </span><span style=color:#79b8ff>{</span><span style=color:#e1e4e8>loss.item()</span><span style=color:#f97583>:.4f</span><span style=color:#79b8ff>}</span><span style=color:#9ecbff>"</span><span style=color:#e1e4e8>)</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d># 5. 可视化训练结果</span></span>
<span class=line><span style=color:#6a737d># 绘制损失曲线</span></span>
<span class=line><span style=color:#e1e4e8>plt.figure(</span><span style=color:#ffab70>figsize</span><span style=color:#f97583>=</span><span style=color:#e1e4e8>(</span><span style=color:#79b8ff>10</span><span style=color:#e1e4e8>, </span><span style=color:#79b8ff>5</span><span style=color:#e1e4e8>))</span></span>
<span class=line><span style=color:#e1e4e8>plt.plot(</span><span style=color:#79b8ff>range</span><span style=color:#e1e4e8>(epochs), losses)</span></span>
<span class=line><span style=color:#e1e4e8>plt.title(</span><span style=color:#9ecbff>"Loss Curve"</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>plt.xlabel(</span><span style=color:#9ecbff>"Epochs"</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>plt.ylabel(</span><span style=color:#9ecbff>"MSE Loss"</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>plt.show()</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d># 绘制预测结果</span></span>
<span class=line><span style=color:#e1e4e8>model.eval()  </span><span style=color:#6a737d># 设置为评估模式</span></span>
<span class=line><span style=color:#f97583>with</span><span style=color:#e1e4e8> torch.no_grad():</span></span>
<span class=line><span style=color:#e1e4e8>    predicted </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> model(x)  </span><span style=color:#6a737d># 模型预测</span></span>
<span class=line></span>
<span class=line><span style=color:#e1e4e8>plt.figure(</span><span style=color:#ffab70>figsize</span><span style=color:#f97583>=</span><span style=color:#e1e4e8>(</span><span style=color:#79b8ff>10</span><span style=color:#e1e4e8>, </span><span style=color:#79b8ff>5</span><span style=color:#e1e4e8>))</span></span>
<span class=line><span style=color:#e1e4e8>plt.scatter(x.numpy(), y.numpy(), </span><span style=color:#ffab70>label</span><span style=color:#f97583>=</span><span style=color:#9ecbff>"Ground Truth"</span><span style=color:#e1e4e8>)  </span><span style=color:#6a737d># 原始数据</span></span>
<span class=line><span style=color:#e1e4e8>plt.plot(x.numpy(), predicted.numpy(), </span><span style=color:#ffab70>color</span><span style=color:#f97583>=</span><span style=color:#9ecbff>"red"</span><span style=color:#e1e4e8>, </span><span style=color:#ffab70>label</span><span style=color:#f97583>=</span><span style=color:#9ecbff>"Predicted"</span><span style=color:#e1e4e8>)  </span><span style=color:#6a737d># 预测结果</span></span>
<span class=line><span style=color:#e1e4e8>plt.legend()</span></span>
<span class=line><span style=color:#e1e4e8>plt.title(</span><span style=color:#9ecbff>"Linear Regression Result"</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>plt.show()</span></span>
<span class=line></span></code></pre><table><thead><tr><th><img alt="" decoding=async height=500 loading=lazy src=/_astro/14.Dww5hGir_1Cc8nK.webp width=1000></th><th><img alt="" decoding=async height=500 loading=lazy src=/_astro/15.DDrt8OZT_1tlDPg.webp width=1000></th></tr></thead><tbody><tr><td>损失曲线</td><td>预测结果</td></tr></tbody></table><p>学习链接：<a href="https://blog.csdn.net/Delusional/article/details/113097030?fromshare=blogdetail&#x26;sharetype=blogdetail&#x26;sharerId=113097030&#x26;sharerefer=PC&#x26;sharesource=m0_72845244&#x26;sharefrom=from_link">详解使⽤pytorch实现线性回归</a></p><h1 id=4-机器学习基础知识>4. 机器学习基础知识<a href=#4-机器学习基础知识 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h1><h2 id=41-机器学习的目标>4.1 机器学习的目标<a href=#41-机器学习的目标 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><p>泛化：模型在未见过的数据上的表现。</p><h3 id=411-拟合和过拟合>4.1.1 ⽋拟合和过拟合<a href=#411-拟合和过拟合 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h3><blockquote><p>根据泛化的定义，我们希望模型在我们没有训练过的数据上也取得很好的效果，⽽不是只在训练集上有很好的效果。</p></blockquote><ul><li><p>欠拟合：模型在训练集和测试集上表现都很差。</p></li><li><p>过拟合：模型在训练集上表现很好，但在测试集上表现很差。</p></li></ul><p>其实很好理解，训练开始时，模型还没有对训练数据中的所有相关模式建模。因此，模型在训练集和测试集上的表现都很差，这就是欠拟合。</p><p>训练到一定程度后，模型开始仅学习和训练数据有关的模式，并且开始学习训练数据中的噪声和细节，但对新数据而言，这些噪声和细节是不相关的。这就是过拟合。</p><p><img alt="" decoding=async height=452 loading=lazy src=/_astro/20.nMUIoJRN_QDG0D.webp width=823></p><h3 id=412-嘈杂的训练数据>4.1.2 嘈杂的训练数据<a href=#412-嘈杂的训练数据 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h3><p>MNIST数据集中就有很多异常值。</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><img alt="" decoding=async height=576 loading=lazy src=/_astro/22.DNt8X0d6_Z1beRXn.webp width=702></td><td><img alt="" decoding=async height=317 loading=lazy src=/_astro/23.C7Vfj-fr_Z2iP5cP.webp width=1144></td></tr></tbody></table><p>如果模型将这些异常值(噪声)全部考虑进去，那么它的泛化性能将会下降</p><p><img alt="" decoding=async height=373 loading=lazy src=/_astro/24.BBad_Wbu_dzFQo.webp width=969></p><p>左边是稳健拟合，右边是过拟合</p><h2 id=42-评估机器学习的性能>4.2 评估机器学习的性能<a href=#42-评估机器学习的性能 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><blockquote><p>优化和泛化之间的矛盾，欠拟合和过拟合之间的矛盾</p></blockquote><h3 id=421-训练集验证集和测试集>4.2.1 训练集、验证集和测试集<a href=#421-训练集验证集和测试集 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h3><ol><li>简单的留出验证<ul><li>一般验证集占数据集的20%</li></ul></li><li>K折交叉验证<ul><li>有时候验证集很少，无法在统计学上代表数据 <img alt="" decoding=async height=452 loading=lazy src=/_astro/21.C-Res1KU_BIulW.webp width=940></li></ul></li></ol><h3 id=422-评估模型的注意事项>4.2.2 评估模型的注意事项<a href=#422-评估模型的注意事项 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h3><ul><li>数据的代表性</li><li>数据冗余</li></ul><h2 id=43-改进模型拟合>4.3 改进模型拟合<a href=#43-改进模型拟合 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><ol><li><p>调节关键梯度下降参数</p><ul><li>学习率</li><li>批量大小</li></ul></li><li><p>利用更好的模型架构</p></li><li><p>提高模型的容量(大小)</p></li></ol><h2 id=44-提高模型的泛化能力>4.4 提高模型的泛化能力<a href=#44-提高模型的泛化能力 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><ol><li>数据集管理</li><li>提前终止，防止过拟合</li><li>模型正则化<ul><li>缩减模型容量</li><li>权重正则化</li><li>Dropout <img alt="" decoding=async height=424 loading=lazy src=/_astro/25.OwpzkrLC_Z1EJwUX.webp width=1001></li></ul></li></ol><h1 id=5-多层感知机mlp从入门到实践>5. 多层感知机（MLP）从入门到实践<a href=#5-多层感知机mlp从入门到实践 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h1><p>在上⾯的线性神经⽹络中我们了解很多深度学习的概念，那现在我们要深⼊对于深度神经⽹络的探索。</p><h2 id=51-隐藏层-hidden-layer>5.1 隐藏层 (Hidden Layer)<a href=#51-隐藏层-hidden-layer class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><blockquote><p>隐藏层是神经⽹络的核⼼，它可以帮助我们学习⾮线性关系。</p></blockquote><p>在线性⽹络中我们描述了仿射变换，这在深度学习种是⼀种线性变换，如果我们的输⼊输出满⾜线性关系，那么这样就⾜够了，但是线性是⼀个很强的假设；线性模型是很容易出错的，因为我们⽆法保证线性相关的关系。</p><p>举例：</p><ol><li><p>我们尝试预测⼀个⼈是否会还贷，我们可以认为，在其他条件不变的情况下，收⼊较⾼的申请⼈⽐收⼊较低的申请⼈更有可能偿还贷款。但是，虽然收⼊与还款概率存在单调性，但它们不是线性相关的。收⼊从0增加到5万，可能⽐从100万增加到105万带来更⼤的还款可能性。</p></li><li><p>我们想要根据体温预测死亡率。 对体温⾼于37摄⽒度的⼈来说，温度越⾼⻛险越⼤。然⽽，对体温低于37摄⽒度的⼈来说，温度越⾼⻛险就越低。</p></li></ol><p>我们可以通过在⽹络中加⼊⼀个或多个隐藏层来克服线性模型的限制，使其能处理更普遍的函数关系类型。最简单的⽅法就是将多个全连接层连接到⼀起，这种架构通常称为多层感知机（multilayer perceptron），通常缩写为 <strong>MLP</strong>。</p><p><img alt="" decoding=async height=395 loading=lazy src=/_astro/17.Bs_Ig4Bw_Z2bNY4A.webp width=693></p><ul><li>这是⼀个两层的⽹络</li><li>对于这种输入和输出的每个节点都相连的层，我们一般称为<strong>全连接层</strong>或<strong>稠密层</strong></li><li>全连接层的开销⾮常⼤，需要权衡性能和参数规模</li></ul><p>仿射变换=权重*参数+偏置</p><blockquote><p>仿射变换的组合还是仿射变换</p></blockquote><p>那么这个模型还是线性的，依然没有解决上述线性模型表达能⼒弱的问题，我们需要有⼀个函数使他变成⾮线性的：<strong>激活函数</strong></p><p>如果没有激活函数，那么每个隐藏层仅仅只是⼀个仿射函数，与线性模型并⽆区别，为了避免多层感知机模型退化成线性模型，我们需要引⼊激活函数。</p><h2 id=52-激活函数-activation-function>5.2 激活函数 (Activation Function)<a href=#52-激活函数-activation-function class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><p>激活函数引⼊⾮线性特性，使神经⽹络能够拟合复杂的函数。</p><h3 id=常见激活函数>常见激活函数<a href=#常见激活函数 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h3><ol><li>Sigmoid</li></ol><span class=katex-display><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML display=block><semantics><mrow><mi>σ</mi><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>x</mi></mrow></msup></mrow></mfrac></mrow><annotation encoding=application/x-tex>\sigma(x) = \frac{1}{1 + e^{-x}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathnormal" style=margin-right:.03588em>σ</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:2.0908em;vertical-align:-.7693em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.3214em><span style=top:-2.314em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>1</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222em></span><span class=mord><span class="mord mathnormal">e</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6973em><span style=top:-2.989em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.677em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.7693em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><ul><li>将输出映射到 (0, 1)，适⽤于概率预测。</li><li>容易引发梯度消失问题。</li></ul><p><img alt="" decoding=async height=447 loading=lazy src=/_astro/19.DP34yd_K_1KMg8H.webp width=823></p><ol><li>Tanh</li></ol><span class=katex-display><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML display=block><semantics><mrow><mi>tanh</mi><mo>⁡</mo><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo><mo>=</mo><mfrac><mrow><msup><mi>e</mi><mi>x</mi></msup><mo>−</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>x</mi></mrow></msup></mrow><mrow><msup><mi>e</mi><mi>x</mi></msup><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>x</mi></mrow></msup></mrow></mfrac></mrow><annotation encoding=application/x-tex>\tanh(x) = \frac{e^x - e^{-x}}{e^x + e^{-x}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mop>tanh</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:2.2177em;vertical-align:-.7693em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.4483em><span style=top:-2.314em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class="mord mathnormal">e</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.5904em><span style=top:-2.989em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222em></span><span class=mord><span class="mord mathnormal">e</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6973em><span style=top:-2.989em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.677em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class="mord mathnormal">e</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6644em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span><span class=mord><span class="mord mathnormal">e</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7713em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.7693em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><ol><li>ReLU (Rectified Linear Unit)</li></ol><span class=katex-display><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML display=block><semantics><mrow><mtext>ReLU</mtext><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo><mo>=</mo><mi>max</mi><mo>⁡</mo><mo stretchy=false>(</mo><mn>0</mn><mo separator=true>,</mo><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{ReLU}(x) = \max(0, x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord text"><span class=mord>ReLU</span></span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mop>max</span><span class=mopen>(</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal">x</span><span class=mclose>)</span></span></span></span></span><ul><li>当输⼊为负时，ReLU函数的导数为0，⽽当输⼊为正时，ReLU函数的导数为1。</li><li>注意，当输⼊值精确等于0时，ReLU函数不可导。在此时，我们默认使⽤左侧的导数，即当输⼊为0时,导数为0。但我们可以忽略这个问题，在⼯程实际中，⼏乎是永远不可能为0的。</li></ul><p><img alt="" decoding=async height=442 loading=lazy src=/_astro/18.yd3RlEzY_1TzfH7.webp width=818></p><ol><li>Softmax</li></ol><span class=katex-display><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML display=block><semantics><mrow><mtext>Softmax</mtext><mo stretchy=false>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=false>)</mo><mo>=</mo><mfrac><msup><mi>e</mi><msub><mi>x</mi><mi>i</mi></msub></msup><mrow><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msup><mi>e</mi><msub><mi>x</mi><mi>j</mi></msub></msup></mrow></mfrac></mrow><annotation encoding=application/x-tex>\text{Softmax}(x_i) = \frac{e^{x_i}}{\sum_{j=1}^n e^{x_j}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord text"><span class=mord>Softmax</span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:2.4715em;vertical-align:-1.1301em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.3414em><span style=top:-2.3057em><span class=pstrut style=height:3em></span><span class=mord><span class=mop><span class="mop op-symbol small-op" style=position:relative;top:0>∑</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8043em><span style=top:-2.4003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.05724em>j</span><span class="mtight mrel">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.4358em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal">e</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6065em><span style=top:-3.0051em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3281em><span style=top:-2.357em;margin-left:0;margin-right:.0714em><span class=pstrut style=height:2.5em></span><span class="mtight sizing reset-size3 size1"><span class="mord mathnormal mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2819em><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.677em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class="mord mathnormal">e</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6644em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3281em><span style=top:-2.357em;margin-left:0;margin-right:.0714em><span class=pstrut style=height:2.5em></span><span class="mtight sizing reset-size3 size1"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.1301em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><ul><li>⽤于多分类任务，将输出转化为概率分布。</li></ul><h2 id=53-softmax分类>5.3 softmax分类<a href=#53-softmax分类 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><p>softmax分类器是多分类问题中常用的分类器，它将输入的特征映射到一个概率分布，使得每个类别的概率之和为1。</p><p><img alt="" decoding=async height=545 loading=lazy src=/_astro/26.Cu68-P--_Z1G2dzY.webp width=1193></p><p>现在经过上面三个公式（等于是三个单独的线性回归）的计算，我们已经得到了三个数；为了得到最后预测结果是啥，我们选择最大概率的标签为预测结果。</p><p>假设输出为0.1，0.8，0.1，那么我们预测的类别就是2</p><h2 id=54-mlp实战mnist写数字识别>5.4 MLP实战——MNIST⼿写数字识别<a href=#54-mlp实战mnist写数字识别 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><p>MNIST数据集包含60,000个训练样本和10,000个测试样本，每个样本是一个28x28像素的灰度图像，表示一个手写数字（0-9）。目标是训练一个模型，能够准确地识别这些手写数字。</p><p>CSDN博客：<a href="https://blog.csdn.net/m0_72845244/article/details/131730803?fromshare=blogdetail&#x26;sharetype=blogdetail&#x26;sharerId=131730803&#x26;sharerefer=PC&#x26;sharesource=m0_72845244&#x26;sharefrom=from_link">keras⼊⻔实例(MNIST数字分类)</a></p><h3 id=pytorch加载数据集>Pytorch加载数据集<a href=#pytorch加载数据集 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h3><pre class="astro-code github-dark" data-language=python style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#f97583>import</span><span style=color:#e1e4e8> torch</span></span>
<span class=line><span style=color:#f97583>from</span><span style=color:#e1e4e8> torchvision </span><span style=color:#f97583>import</span><span style=color:#e1e4e8> datasets, transforms</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d># 数据预处理</span></span>
<span class=line><span style=color:#e1e4e8>transform </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> transforms.Compose([</span></span>
<span class=line><span style=color:#e1e4e8>    transforms.ToTensor(),  </span><span style=color:#6a737d># 转为 PyTorch 的 Tensor 格式</span></span>
<span class=line><span style=color:#e1e4e8>    transforms.Normalize((</span><span style=color:#79b8ff>0.5</span><span style=color:#e1e4e8>,), (</span><span style=color:#79b8ff>0.5</span><span style=color:#e1e4e8>,))  </span><span style=color:#6a737d># 对数据进行归一化，均值和标准差为 0.5</span></span>
<span class=line><span style=color:#e1e4e8>])</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d># 加载训练集和测试集</span></span>
<span class=line><span style=color:#e1e4e8>train_dataset </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> datasets.MNIST(</span><span style=color:#ffab70>root</span><span style=color:#f97583>=</span><span style=color:#9ecbff>'./data'</span><span style=color:#e1e4e8>, </span><span style=color:#ffab70>train</span><span style=color:#f97583>=</span><span style=color:#79b8ff>True</span><span style=color:#e1e4e8>, </span><span style=color:#ffab70>transform</span><span style=color:#f97583>=</span><span style=color:#e1e4e8>transform, </span><span style=color:#ffab70>download</span><span style=color:#f97583>=</span><span style=color:#79b8ff>True</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>test_dataset </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> datasets.MNIST(</span><span style=color:#ffab70>root</span><span style=color:#f97583>=</span><span style=color:#9ecbff>'./data'</span><span style=color:#e1e4e8>, </span><span style=color:#ffab70>train</span><span style=color:#f97583>=</span><span style=color:#79b8ff>False</span><span style=color:#e1e4e8>, </span><span style=color:#ffab70>transform</span><span style=color:#f97583>=</span><span style=color:#e1e4e8>transform, </span><span style=color:#ffab70>download</span><span style=color:#f97583>=</span><span style=color:#79b8ff>True</span><span style=color:#e1e4e8>)</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d># 数据加载器</span></span>
<span class=line><span style=color:#e1e4e8>train_loader </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> torch.utils.data.DataLoader(</span><span style=color:#ffab70>dataset</span><span style=color:#f97583>=</span><span style=color:#e1e4e8>train_dataset, </span><span style=color:#ffab70>batch_size</span><span style=color:#f97583>=</span><span style=color:#79b8ff>64</span><span style=color:#e1e4e8>, </span><span style=color:#ffab70>shuffle</span><span style=color:#f97583>=</span><span style=color:#79b8ff>True</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>test_loader </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> torch.utils.data.DataLoader(</span><span style=color:#ffab70>dataset</span><span style=color:#f97583>=</span><span style=color:#e1e4e8>test_dataset, </span><span style=color:#ffab70>batch_size</span><span style=color:#f97583>=</span><span style=color:#79b8ff>64</span><span style=color:#e1e4e8>, </span><span style=color:#ffab70>shuffle</span><span style=color:#f97583>=</span><span style=color:#79b8ff>False</span><span style=color:#e1e4e8>)</span></span>
<span class=line></span>
<span class=line><span style=color:#79b8ff>print</span><span style=color:#e1e4e8>(</span><span style=color:#f97583>f</span><span style=color:#9ecbff>"训练集样本数: </span><span style=color:#79b8ff>{len</span><span style=color:#e1e4e8>(train_dataset)</span><span style=color:#79b8ff>}</span><span style=color:#9ecbff>"</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#79b8ff>print</span><span style=color:#e1e4e8>(</span><span style=color:#f97583>f</span><span style=color:#9ecbff>"测试集样本数: </span><span style=color:#79b8ff>{len</span><span style=color:#e1e4e8>(test_dataset)</span><span style=color:#79b8ff>}</span><span style=color:#9ecbff>"</span><span style=color:#e1e4e8>)</span></span>
<span class=line></span></code></pre><p><a href="https://www.bilibili.com/video/BV1Rz4y1h7nN/?share_source=copy_web&#x26;vd_source=e4838a460d5e965db0426ab9bd050b56">神经网络可视化</a></p><h1 id=5-linux下配置深度学习环境>5. Linux下配置深度学习环境<a href=#5-linux下配置深度学习环境 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h1><h2 id=51-安装显卡驱动>5.1 安装显卡驱动<a href=#51-安装显卡驱动 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><p>强烈建议通过ubuntu22.04的官⽅GUI软件 <strong>软件和更新</strong> 安装显卡驱动。(Linux官⽅把nvidia驱动已经做的相当好了，安装起来也很⽅便。但是NVIDIA驱动其实还会有各式各样的BUG，包括Linux之⽗Linus Torvalds曾经说过的那样：“NVIDIA是最难伺候的硬件制造商，也是我们接触过最糟糕的公司，没有之⼀，<del>SO NVIDIA FUCKNVIDIA YOU</del>”.)</p><p>图标⻓这样(有时候它是灰⾊的), <img alt="" decoding=async height=165 loading=lazy src=/_astro/6.DCMjhfYp_2bcTvP.webp width=133></p><p>安装成功后在终端使⽤<code>nvidia-smi</code>可以看到GPU信息，看到就算安装成功</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#b392f0>nvidia-smi</span></span>
<span class=line></span></code></pre><p><img alt="" decoding=async height=329 loading=lazy src=/_astro/8.D9R2csOM_13iosT.webp width=1139></p><p>这⾥显⽰的CUDA版本是最⾼⽀持版本，安装个⽐这低的就⾏(但是也不能太低，下⾯会讲)。</p><p><img alt="" decoding=async height=724 loading=lazy src=/_astro/7.BIPx_Sx8_Z1s1Elx.webp width=838></p><p>如果想要更改显卡驱动，也可以在这⾥改。</p><blockquote><p>显卡驱动安装需要谨慎对待，尽量安装recommend版本，否则可能会导致ubuntu桌⾯不显⽰、开机不了、电脑副屏幕不显⽰等问题。</p></blockquote><blockquote><p>装错显卡驱动时，不到万不得已，不要使⽤<code>sudo apt autoremove</code>，这是下下策。</p></blockquote><h2 id=52-安装cuda>5.2 安装CUDA<a href=#52-安装cuda class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><p>显卡驱动版本和CUDA版本有⼀定的对应关系。</p><p>CUDA版本：<a href=https://developer.nvidia.com/cuda-toolkit-archive>CUDA Toolkit Archive</a></p><p>CUDA版本和驱动版本的对应关系可以看: <a href="https://sundaygeek.blog.csdn.net/article/details/86695400?fromshare=blogdetail&#x26;sharetype=blogdetail&#x26;sharerId=86695400&#x26;sharerefer=PC&#x26;sharesource=m0_72845244&#x26;sharefrom=from_link">不同版本cuda对应的NVIDIA驱动版本</a></p><blockquote><p>但是CUDA版本也不⼀定是越新越好，某些较新的CUDA版本可能没有pytorch的适配版本，所以安装时要注意。(这其实是配环境很常⻅的事情，不同软件由不同公司⼚家开发，进度各有快慢，版本兼容性也不⼀样，所以需要注意。)</p></blockquote><p><strong>不要下载deb格式的，下载runfile！！！！</strong></p><p>Cuda的⼀个安装教程： <a href=https://yinguobing.com/install-cuda11-with-runfile/ >https://yinguobing.com/install-cuda11-with-runfile/</a></p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#b392f0>nvcc</span><span style=color:#79b8ff> -V</span></span>
<span class=line></span></code></pre><p><img alt="" decoding=async height=329 loading=lazy src=/_astro/8.D9R2csOM_13iosT.webp width=1139></p><p>如果显⽰了这个代表安装成功。这⾥显⽰的CUDA版本是11.5，同学们也可以下载这个版本的CUDA。</p><h2 id=53-安装python环境>5.3 安装Python环境<a href=#53-安装python环境 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><p>我们要使⽤pip⼯具安装深度学习的⼀些包，有numpy、tensorflow、keras、pytorch等</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#b392f0>pip</span><span style=color:#9ecbff> install</span><span style=color:#9ecbff> numpy</span><span style=color:#9ecbff> tensorflow</span><span style=color:#9ecbff> keras</span><span style=color:#9ecbff> torch</span><span style=color:#9ecbff> torchvision</span><span style=color:#79b8ff> -i</span><span style=color:#9ecbff> https://pypi.tuna.tsinghua.edu.cn/simple</span></span>
<span class=line></span></code></pre><p>后⾯的 <a href=https://pypi.tuna.tsinghua.edu.cn/simple>https://pypi.tuna.tsinghua.edu.cn/simple</a> 是清华⼤学的镜像源地址，下载速度⽐较快。</p><p>如果不想安装tensorflow，可以只安装pytorch。把 tensorflow keras 去掉。</p><blockquote><p>这⾥的安装命令是安装最新版本适配你电脑python环境的包，如果想安装特定版本的包，可以加上版本号。</p></blockquote><blockquote><p>如果发现还是下载不了，也可以在官⽹上找到你想要torch和torchvision的版本，然后⼿动下载安装。</p></blockquote><p>官⽹下载：<a href=https://download.pytorch.org/whl/torch_stable.html>torch版本⼤全</a></p><p>然后使⽤pip安装。</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#b392f0>pip</span><span style=color:#9ecbff> install</span><span style=color:#79b8ff> *</span><span style=color:#9ecbff>.whl</span></span>
<span class=line></span></code></pre><p>最后，检查⼀下pytorch是否安装成功。是否能使⽤cuda。</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#b392f0>python</span></span>
<span class=line><span style=color:#b392f0>import</span><span style=color:#9ecbff> torch</span></span>
<span class=line><span style=color:#b392f0>torch.cuda.is_available</span><span style=color:#e1e4e8>()</span></span>
<span class=line></span></code></pre><p>如果能输出True，那么恭喜你安装成功。</p><h2 id=54-安装anaconda>5.4 安装Anaconda<a href=#54-安装anaconda class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><p>Anaconda是⼀个python包管理虚拟环境（可装可不装，不过还是建议装上）</p><p>官⽹： <a href=https://zhuanlan.zhihu.com/p/459607806>https://zhuanlan.zhihu.com/p/459607806</a></p><p>可以参考的国内教程： <a href=https://zhuanlan.zhihu.com/p/459607806>https://zhuanlan.zhihu.com/p/459607806</a></p><p>官⽹安装教程： <a href=https://docs.anaconda.com/free/anaconda/install/linux/ >https://docs.anaconda.com/free/anaconda/install/linux/</a></p><p>因为ubuntu22.04默认安装了python3.10.7，正常就是ROS2 Humble需要的python版本，所以可以直接使⽤本机的python版本。</p><blockquote><p>如果有需要使⽤某些Qt程序，⽐如PyQt5，可能需要利⽤Anacoda安装python的3.9版本才能使⽤Qt。正常使⽤时来回切换python版本即可。</p></blockquote><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#b392f0>conda</span><span style=color:#9ecbff> create</span><span style=color:#79b8ff> -n</span><span style=color:#9ecbff> XXX</span><span style=color:#9ecbff> python=</span><span style=color:#79b8ff>3.9</span></span>
<span class=line><span style=color:#b392f0>conda</span><span style=color:#9ecbff> activate</span><span style=color:#9ecbff> XXX</span><span style=color:#6a737d> # 进入虚拟环境</span></span>
<span class=line></span></code></pre><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#b392f0>conda</span><span style=color:#9ecbff> deactivate</span><span style=color:#6a737d> # 退出虚拟环境</span></span>
<span class=line></span></code></pre><blockquote><p>如果配置有困难的同学可以先使⽤<code>Google Colab</code>进⾏深度学习实验。但是配环境是每⼀个RoboMaster 视觉组新⼿⼩⽩都需要的基本能⼒，建议⼤家都掌握。</p></blockquote><hr><h1 id=作业>作业<a href=#作业 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h1><p>重新实现课上的MNIST⼿写数字识别分类的例子。</p><p>要求：</p><ol><li>使用PyTorch实现。</li><li>要求使用<strong>多层感知机MLP</strong>模型。</li><li>在Gitee中提交python代码或或ipynb文件和训练结果(曲线图)。</li></ol><p>截止日期：看群通知。</p></div><div class="transition overflow-hidden bg-[var(--license-block-bg)] license-container mb-6 onload-animation px-6 py-5 relative rounded-xl"><div class="transition font-bold dark:text-white/75 text-black/75">深度学习基础</div><a href=https://riyuexingchennnn.github.io/posts/深度学习基础/ class="text-[var(--primary)] link">https://riyuexingchennnn.github.io/posts/深度学习基础/</a><div class="flex gap-6 mt-2"><div><div class="transition text-sm dark:text-white/30 text-black/30">作者</div><div class="transition dark:text-white/75 text-black/75 whitespace-nowrap">日月星辰</div></div><div><div class="transition text-sm dark:text-white/30 text-black/30">发布于</div><div class="transition dark:text-white/75 text-black/75 whitespace-nowrap">2024-11-27</div></div><div><div class="transition text-sm dark:text-white/30 text-black/30">许可协议</div><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/ class="text-[var(--primary)] link whitespace-nowrap" target=_blank>CC BY-NC-SA 4.0</a></div></div><svg data-icon=fa6-brands:creative-commons height=1em viewBox="0 0 496 512" width=0.97em class="transition absolute pointer-events-none -translate-y-1/2 dark:text-white/5 right-6 text-[15rem] text-black/5 top-1/2"><symbol id=ai:fa6-brands:creative-commons><path d="m245.83 214.87l-33.22 17.28c-9.43-19.58-25.24-19.93-27.46-19.93c-22.13 0-33.22 14.61-33.22 43.84c0 23.57 9.21 43.84 33.22 43.84c14.47 0 24.65-7.09 30.57-21.26l30.55 15.5c-6.17 11.51-25.69 38.98-65.1 38.98c-22.6 0-73.96-10.32-73.96-77.05c0-58.69 43-77.06 72.63-77.06c30.72-.01 52.7 11.95 65.99 35.86m143.05 0l-32.78 17.28c-9.5-19.77-25.72-19.93-27.9-19.93c-22.14 0-33.22 14.61-33.22 43.84c0 23.55 9.23 43.84 33.22 43.84c14.45 0 24.65-7.09 30.54-21.26l31 15.5c-2.1 3.75-21.39 38.98-65.09 38.98c-22.69 0-73.96-9.87-73.96-77.05c0-58.67 42.97-77.06 72.63-77.06c30.71-.01 52.58 11.95 65.56 35.86M247.56 8.05C104.74 8.05 0 123.11 0 256.05c0 138.49 113.6 248 247.56 248c129.93 0 248.44-100.87 248.44-248c0-137.87-106.62-248-248.44-248m.87 450.81c-112.54 0-203.7-93.04-203.7-202.81c0-105.42 85.43-203.27 203.72-203.27c112.53 0 202.82 89.46 202.82 203.26c-.01 121.69-99.68 202.82-202.84 202.82" fill=currentColor /></symbol><use xlink:href=#ai:fa6-brands:creative-commons></use></svg></div></div></div><div class="flex flex-col gap-4 w-full mb-4 justify-between md:flex-row overflow-hidden"><a href=# class="overflow-hidden w-full active:scale-95 font-bold pointer-events-none"></a> <a href=/posts/计算机视觉深度学习入门/ class="overflow-hidden w-full active:scale-95 font-bold"><div class="flex items-center gap-4 btn-card h-[3.75rem] justify-end max-w-full px-4 rounded-2xl w-full"><div class="transition dark:text-white/75 text-black/75 whitespace-nowrap max-w-[calc(100%_-_3rem)] overflow-ellipsis overflow-hidden">计算机视觉深度学习入门</div><svg data-icon=material-symbols:chevron-right-rounded height=1em viewBox="0 0 24 24" width=1em class="text-[var(--primary)] text-[2rem]"><symbol id=ai:material-symbols:chevron-right-rounded><path d="M12.6 12L8.7 8.1q-.275-.275-.275-.7t.275-.7t.7-.275t.7.275l4.6 4.6q.15.15.213.325t.062.375t-.062.375t-.213.325l-4.6 4.6q-.275.275-.7.275t-.7-.275t-.275-.7t.275-.7z" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:chevron-right-rounded></use></svg></div></a></div><div class="onload-animation col-span-2 footer hidden lg:block"><div class="transition border-dashed dark:border-white/15 border-black/10 border-t mx-32 my-10"></div><div class="flex items-center justify-center transition border-[oklch(85%_0.01_var(--hue))] border-dashed dark:border-white/15 flex-col mb-12 px-6 rounded-2xl"><div class="transition text-sm text-50 text-center">&copy; <span id=copyright-year>2024</span> 日月星辰. All Rights Reserved. / <a href=/rss.xml class="transition font-medium link text-[var(--primary)]" target=_blank>RSS</a> / <a href=/sitemap-index.xml class="transition font-medium link text-[var(--primary)]" target=_blank>Sitemap</a><br>Powered by <a href=https://astro.build class="transition font-medium link text-[var(--primary)]" target=_blank>Astro</a> & <a href=https://github.com/saicaca/fuwari class="transition font-medium link text-[var(--primary)]" target=_blank>Fuwari</a></div></div></div></div></main><div class="onload-animation col-span-2 footer block lg:hidden"><div class="transition border-dashed dark:border-white/15 border-black/10 border-t mx-32 my-10"></div><div class="flex items-center justify-center transition border-[oklch(85%_0.01_var(--hue))] border-dashed dark:border-white/15 flex-col mb-12 px-6 rounded-2xl"><div class="transition text-sm text-50 text-center">&copy; <span id=copyright-year>2024</span> 日月星辰. All Rights Reserved. / <a href=/rss.xml class="transition font-medium link text-[var(--primary)]" target=_blank>RSS</a> / <a href=/sitemap-index.xml class="transition font-medium link text-[var(--primary)]" target=_blank>Sitemap</a><br>Powered by <a href=https://astro.build class="transition font-medium link text-[var(--primary)]" target=_blank>Astro</a> & <a href=https://github.com/saicaca/fuwari class="transition font-medium link text-[var(--primary)]" target=_blank>Fuwari</a></div></div></div></div><div class="back-to-top-wrapper hidden lg:block" data-astro-cid-eymb5ayk><div class="flex items-center transition rounded-2xl back-to-top-btn hide overflow-hidden" id=back-to-top-btn data-astro-cid-eymb5ayk onclick=backToTop()><button class="btn-card h-[3.75rem] w-[3.75rem]" aria-label="Back to Top" data-astro-cid-eymb5ayk><svg data-icon=material-symbols:keyboard-arrow-up-rounded height=1em viewBox="0 0 24 24" width=1em class=mx-auto data-astro-cid-eymb5ayk><symbol id=ai:material-symbols:keyboard-arrow-up-rounded><path d="m12 10.8l-3.9 3.9q-.275.275-.7.275t-.7-.275t-.275-.7t.275-.7l4.6-4.6q.3-.3.7-.3t.7.3l4.6 4.6q.275.275.275.7t-.275.7t-.7.275t-.7-.275z" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:keyboard-arrow-up-rounded></use></svg></button></div></div><script>function backToTop(){window.scroll({top:0,behavior:"smooth"})}</script></div></div><div class="absolute w-full z-0"><div class="mx-auto relative max-w-[var(--page-width)]"><div class="flex items-center transition absolute -right-[var(--toc-width)] hidden lg:block top-0 w-[var(--toc-width)]" id=toc-wrapper><div class="h-[calc(100vh_-_20rem)] fixed hide-scrollbar overflow-x-hidden overflow-y-scroll top-14 w-[var(--toc-width)]" id=toc-inner-wrapper><div class="transition-swup-fade h-full w-full" id=toc><div class="h-8 w-full"></div><div><a href=#前言 class="flex transition py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="flex items-center rounded-lg font-bold justify-center h-5 shrink-0 text-xs w-5 bg-[var(--toc-badge-bg)] text-[var(--btn-content)]">1</div><div class="text-sm text-50">前言</div></a><a href=#1-初识深度学习 class="flex transition py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="flex items-center rounded-lg font-bold justify-center h-5 shrink-0 text-xs w-5 bg-[var(--toc-badge-bg)] text-[var(--btn-content)]">2</div><div class="text-sm text-50">1. 初识深度学习</div></a><a href=#11-什么是深度学习 class="flex transition py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="flex items-center rounded-lg font-bold justify-center h-5 shrink-0 text-xs w-5 ml-4"><div class="bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="text-sm text-50">1.1 什么是深度学习</div></a><a href=#12-robomaster与深度学习 class="flex transition py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="flex items-center rounded-lg font-bold justify-center h-5 shrink-0 text-xs w-5 ml-4"><div class="bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="text-sm text-50">1.2 RoboMaster与深度学习</div></a><a href=#13-机器学习与深度学习 class="flex transition py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="flex items-center rounded-lg font-bold justify-center h-5 shrink-0 text-xs w-5 ml-4"><div class="bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="text-sm text-50">1.3 机器学习与深度学习</div></a><a href=#14-机器学习算法 class="flex transition py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="flex items-center rounded-lg font-bold justify-center h-5 shrink-0 text-xs w-5 ml-4"><div class="bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="text-sm text-50">1.4 机器学习算法</div></a><a href=#14-用三张图理解深度学习的工作原理 class="flex transition py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="flex items-center rounded-lg font-bold justify-center h-5 shrink-0 text-xs w-5 ml-4"><div class="bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="text-sm text-50">1.4 用三张图理解深度学习的工作原理</div></a><a href=#15-深度学习的硬件 class="flex transition py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="flex items-center rounded-lg font-bold justify-center h-5 shrink-0 text-xs w-5 ml-4"><div class="bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="text-sm text-50">1.5 深度学习的硬件</div></a><a href=#16-深度学习的历史与发展 class="flex transition py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="flex items-center rounded-lg font-bold justify-center h-5 shrink-0 text-xs w-5 ml-4"><div class="bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="text-sm text-50">1.6 深度学习的历史与发展</div></a><a href=#2-神经网络的基本数学概念 class="flex transition py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="flex items-center rounded-lg font-bold justify-center h-5 shrink-0 text-xs w-5 bg-[var(--toc-badge-bg)] text-[var(--btn-content)]">3</div><div class="text-sm text-50">2. 神经网络的基本数学概念</div></a><a href=#21-张量-tensor-介绍 class="flex transition py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="flex items-center rounded-lg font-bold justify-center h-5 shrink-0 text-xs w-5 ml-4"><div class="bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="text-sm text-50">2.1 张量 (Tensor) 介绍</div></a><a href=#22-张量运算的导数梯度-gradient class="flex transition py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="flex items-center rounded-lg font-bold justify-center h-5 shrink-0 text-xs w-5 ml-4"><div class="bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="text-sm text-50">2.2 张量运算的导数——梯度 (Gradient)</div></a><a href=#23-链式求导chain-rule class="flex transition py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="flex items-center rounded-lg font-bold justify-center h-5 shrink-0 text-xs w-5 ml-4"><div class="bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="text-sm text-50">2.3 链式求导（Chain Rule）</div></a><a href=#24-随机梯度下降-stochastic-gradient-descent class="flex transition py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="flex items-center rounded-lg font-bold justify-center h-5 shrink-0 text-xs w-5 ml-4"><div class="bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="text-sm text-50">2.4 随机梯度下降 (Stochastic Gradient Descent)</div></a><a href=#25-反向传播-backpropagation class="flex transition py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="flex items-center rounded-lg font-bold justify-center h-5 shrink-0 text-xs w-5 ml-4"><div class="bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="text-sm text-50">2.5 反向传播 (Backpropagation)</div></a><a href=#26-优化器-optimizer class="flex transition py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="flex items-center rounded-lg font-bold justify-center h-5 shrink-0 text-xs w-5 ml-4"><div class="bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="text-sm text-50">2.6 优化器 (Optimizer)</div></a><a href=#27-用计算图看正向传播和反向传播 class="flex transition py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="flex items-center rounded-lg font-bold justify-center h-5 shrink-0 text-xs w-5 ml-4"><div class="bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="text-sm text-50">2.7 用计算图看正向传播和反向传播</div></a><a href=#3-从线性回归到神经网络 class="flex transition py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="flex items-center rounded-lg font-bold justify-center h-5 shrink-0 text-xs w-5 bg-[var(--toc-badge-bg)] text-[var(--btn-content)]">4</div><div class="text-sm text-50">3. 从线性回归到神经网络</div></a><a href=#31-主要目的 class="flex transition py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="flex items-center rounded-lg font-bold justify-center h-5 shrink-0 text-xs w-5 ml-4"><div class="bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="text-sm text-50">3.1 主要目的</div></a><a href=#32-任务目标 class="flex transition py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="flex items-center rounded-lg font-bold justify-center h-5 shrink-0 text-xs w-5 ml-4"><div class="bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="text-sm text-50">3.2 任务目标</div></a><a href=#33-损失函数-loss-function class="flex transition py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="flex items-center rounded-lg font-bold justify-center h-5 shrink-0 text-xs w-5 ml-4"><div class="bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="text-sm text-50">3.3 损失函数 (Loss Function)</div></a><a href=#34-代码实现 class="flex transition py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="flex items-center rounded-lg font-bold justify-center h-5 shrink-0 text-xs w-5 ml-4"><div class="bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="text-sm text-50">3.4 代码实现</div></a><a href=#4-机器学习基础知识 class="flex transition py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="flex items-center rounded-lg font-bold justify-center h-5 shrink-0 text-xs w-5 bg-[var(--toc-badge-bg)] text-[var(--btn-content)]">5</div><div class="text-sm text-50">4. 机器学习基础知识</div></a><a href=#41-机器学习的目标 class="flex transition py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="flex items-center rounded-lg font-bold justify-center h-5 shrink-0 text-xs w-5 ml-4"><div class="bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="text-sm text-50">4.1 机器学习的目标</div></a><a href=#42-评估机器学习的性能 class="flex transition py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="flex items-center rounded-lg font-bold justify-center h-5 shrink-0 text-xs w-5 ml-4"><div class="bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="text-sm text-50">4.2 评估机器学习的性能</div></a><a href=#43-改进模型拟合 class="flex transition py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="flex items-center rounded-lg font-bold justify-center h-5 shrink-0 text-xs w-5 ml-4"><div class="bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="text-sm text-50">4.3 改进模型拟合</div></a><a href=#44-提高模型的泛化能力 class="flex transition py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="flex items-center rounded-lg font-bold justify-center h-5 shrink-0 text-xs w-5 ml-4"><div class="bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="text-sm text-50">4.4 提高模型的泛化能力</div></a><a href=#5-多层感知机mlp从入门到实践 class="flex transition py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="flex items-center rounded-lg font-bold justify-center h-5 shrink-0 text-xs w-5 bg-[var(--toc-badge-bg)] text-[var(--btn-content)]">6</div><div class="text-sm text-50">5. 多层感知机（MLP）从入门到实践</div></a><a href=#51-隐藏层-hidden-layer class="flex transition py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="flex items-center rounded-lg font-bold justify-center h-5 shrink-0 text-xs w-5 ml-4"><div class="bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="text-sm text-50">5.1 隐藏层 (Hidden Layer)</div></a><a href=#52-激活函数-activation-function class="flex transition py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="flex items-center rounded-lg font-bold justify-center h-5 shrink-0 text-xs w-5 ml-4"><div class="bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="text-sm text-50">5.2 激活函数 (Activation Function)</div></a><a href=#53-softmax分类 class="flex transition py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="flex items-center rounded-lg font-bold justify-center h-5 shrink-0 text-xs w-5 ml-4"><div class="bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="text-sm text-50">5.3 softmax分类</div></a><a href=#54-mlp实战mnist写数字识别 class="flex transition py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="flex items-center rounded-lg font-bold justify-center h-5 shrink-0 text-xs w-5 ml-4"><div class="bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="text-sm text-50">5.4 MLP实战——MNIST⼿写数字识别</div></a><a href=#5-linux下配置深度学习环境 class="flex transition py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="flex items-center rounded-lg font-bold justify-center h-5 shrink-0 text-xs w-5 bg-[var(--toc-badge-bg)] text-[var(--btn-content)]">7</div><div class="text-sm text-50">5. Linux下配置深度学习环境</div></a><a href=#51-安装显卡驱动 class="flex transition py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="flex items-center rounded-lg font-bold justify-center h-5 shrink-0 text-xs w-5 ml-4"><div class="bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="text-sm text-50">5.1 安装显卡驱动</div></a><a href=#52-安装cuda class="flex transition py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="flex items-center rounded-lg font-bold justify-center h-5 shrink-0 text-xs w-5 ml-4"><div class="bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="text-sm text-50">5.2 安装CUDA</div></a><a href=#53-安装python环境 class="flex transition py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="flex items-center rounded-lg font-bold justify-center h-5 shrink-0 text-xs w-5 ml-4"><div class="bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="text-sm text-50">5.3 安装Python环境</div></a><a href=#54-安装anaconda class="flex transition py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="flex items-center rounded-lg font-bold justify-center h-5 shrink-0 text-xs w-5 ml-4"><div class="bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="text-sm text-50">5.4 安装Anaconda</div></a><a href=#作业 class="flex transition py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="flex items-center rounded-lg font-bold justify-center h-5 shrink-0 text-xs w-5 bg-[var(--toc-badge-bg)] text-[var(--btn-content)]">8</div><div class="text-sm text-50">作业</div></a></div><div class="h-8 w-full"></div></div></div></div><!-- #toc needs to exist for Swup to work normally --></div></div></div><div class="h-[300vh] hidden" id=page-height-extend style=--bannerOffset:30vh;--banner-height-home:65vh;--banner-height:35vh;--configHue:250;--page-width:75rem data-astro-cid-sckkx6r4></div></body></html>